import{a as D}from"./chunk-KVUUTEVL.js";import{c as U,g as A,h as B,i as O,j as R,k as W,s as j,v as G,x as Y}from"./chunk-7SPEZXFY.js";import{e as T,g as V}from"./chunk-FNRIZEXN.js";import{b as N,c as P}from"./chunk-SUSGIDRG.js";import"./chunk-G5ZNMOVD.js";import{r as q}from"./chunk-PDCKKOJZ.js";import{$b as k,Cb as M,Ha as g,Ia as f,Kb as b,Mb as u,Rb as E,Vb as i,Wb as n,Xb as h,ec as S,gc as F,nc as v,oc as l,pb as d,qb as p,rc as w,sc as y,tc as x,vc as I,xa as L}from"./chunk-6ZMI5GLR.js";function z(t,a){if(t&1&&h(0,"app-feedback-message",6),t&2){let _=F();u("message",_.feedbackMessage())}}function H(t,a){t&1&&(i(0,"div",7),h(1,"i",26),l(2," Identity Yourself to access secured resource..! "),n())}function J(t,a){t&1&&(i(0,"div",8),h(1,"i",26),l(2," You have been successfully logged out! "),n())}function K(t,a){t&1&&(i(0,"div",9),h(1,"i",26),l(2," Identity Yourself to access more exciting features..! "),n())}function Q(t,a){t&1&&(i(0,"div"),l(1,"Username is required."),n())}function X(t,a){t&1&&(i(0,"div"),l(1,"Username must be at most 50 characters long."),n())}function Z(t,a){t&1&&(i(0,"div"),l(1,"Password is required."),n())}function $(t,a){t&1&&(i(0,"div"),l(1,"Password must be at most 50 characters long."),n())}var me=(()=>{let a=class a{constructor(r,o,e,c){this.authService=r,this.loginService=o,this.router=e,this.activatedRoute=c,this.feedbackMessage=M({}),this.form=new C,this.messageBanner=""}ngOnInit(){this.messageBanner=this.activatedRoute.snapshot.queryParams.q}login(r){if(r.valid){let o={username:this.form.userName,password:this.form.password};this.loginService.login(o).subscribe({next:e=>this.onLoginSuccess(o,e),error:e=>{r.resetForm(),this.onLoginFailed(e)}})}}onLoginSuccess(r,o){if(o.additionalFactorRequired){let e={credential:r,options:o.securityAttributes};this.router.navigate(["mfa"],{queryParams:this.activatedRoute.snapshot.queryParams,state:e}).then(console.log)}else{let e=this.authService.getUserContextForSuccessfulLogin(o);this.onLogOnSuccess(e)}}onLoginFailed(r){console.error(r),this.feedbackMessage.set({error:"Login failed. "+r.message})}onLogOnSuccess(r){this.feedbackMessage.set({success:"Login successful for "+r.name});let o=this.activatedRoute.snapshot.queryParams.redirectUrl??"/home";this.router.navigateByUrl(o).then(console.log)}loginAsGuest(){this.loginService.loginAsGuest().subscribe({next:r=>{let o=this.authService.getUserContextForSuccessfulLogin(r);this.onLogOnSuccess(o)},error:r=>this.onLoginFailed(r)})}};a.\u0275fac=function(o){return new(o||a)(p(P),p(N),p(V),p(T))},a.\u0275cmp=L({type:a,selectors:[["app-login"]],standalone:!0,features:[I],decls:39,vars:10,consts:[["loginForm","ngForm"],["username","ngModel"],["password","ngModel"],[1,"container","h-100","mt-3","mt-md-0"],[1,"row","d-flex","justify-content-center","align-items-center","h-100","m-auto"],[1,"col-12","col-md-6","mt-sm-0"],[3,"message"],["role","alert",1,"alert","alert-warning"],["role","alert",1,"alert","alert-success"],["role","alert",1,"alert","alert-primary"],[1,"card","login-card","text-white","border","border-2","border-primary","border-opacity-50",2,"border-radius","1rem"],[1,"card-body","p-5","text-center"],[3,"ngSubmit"],[1,"fw-bold","mb-2"],[1,"text-white-50","mb-5"],[1,"form-outline","form-white","mb-4"],["type","email","id","username","name","username","required","","autocomplete","username","maxlength","50",1,"form-control","form-control-lg",3,"ngModelChange","ngModel"],["for","username",1,"form-label"],[1,"form-text","text-danger",3,"hidden"],[4,"ngIf"],["type","password","id","password","name","password","required","","maxlength","50","autocomplete","current-password",1,"form-control","form-control-lg",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],[1,"d-flex","flex-column","gap-1"],["type","submit",1,"btn","btn-outline-dark","btn-lg",3,"disabled"],[1,"text-light"],["type","button",1,"btn","btn-success","btn-lg",3,"click"],[1,"bi","bi-info-circle","pe-none","me-2"]],template:function(o,e){if(o&1){let c=k();i(0,"div",3)(1,"div",4)(2,"div",5)(3,"div"),b(4,z,1,1,"app-feedback-message",6)(5,H,3,0,"div",7)(6,J,3,0,"div",8)(7,K,3,0,"div",9),n(),i(8,"div",10)(9,"div",11)(10,"form",12,0),S("ngSubmit",function(){g(c);let s=v(11);return f(e.login(s))}),i(12,"h2",13),l(13,"Login"),n(),i(14,"p",14),l(15,"Please Identify Yourself!"),n(),i(16,"div",15)(17,"input",16,1),x("ngModelChange",function(s){return g(c),y(e.form.userName,s)||(e.form.userName=s),f(s)}),n(),i(19,"label",17),l(20,"Username"),n(),i(21,"div",18),b(22,Q,2,0,"div",19)(23,X,2,0,"div",19),n()(),i(24,"div",15)(25,"input",20,2),x("ngModelChange",function(s){return g(c),y(e.form.password,s)||(e.form.password=s),f(s)}),n(),i(27,"label",21),l(28,"Password"),n(),i(29,"div",18),b(30,Z,2,0,"div",19)(31,$,2,0,"div",19),n()(),i(32,"div",22)(33,"button",23),l(34,"Submit "),n(),i(35,"small",24),l(36,"or"),n(),i(37,"button",25),S("click",function(){return g(c),f(e.loginAsGuest())}),l(38,"Login as Guest"),n()()()()()()()()}if(o&2){let c=v(11),m=v(18),s=v(26);d(4),E(e.feedbackMessage().success||e.feedbackMessage().error?4:e.messageBanner==="unauthenticated"?5:e.messageBanner==="logoutSuccessful"?6:7),d(13),w("ngModel",e.form.userName),d(4),u("hidden",m.valid||m.pristine),d(),u("ngIf",m.errors==null?null:m.errors.required),d(),u("ngIf",m.errors==null?null:m.errors.maxlength),d(2),w("ngModel",e.form.password),d(4),u("hidden",s.valid||s.pristine),d(),u("ngIf",s.errors==null?null:s.errors.required),d(),u("ngIf",s.errors==null?null:s.errors.maxlength),d(2),u("disabled",!c.form.valid||c.submitted)}},dependencies:[Y,W,U,A,B,j,G,R,O,D,q],styles:[".login-card[_ngcontent-%COMP%]{background-image:linear-gradient(to right top,#fff,#e2ddfb,#c3bdf7,#a29df2,#7d7fed,#686fea,#4f5fe6,#2c4fe2,#2647df,#203fdc,#1a37d9,#152ed5)}"]});let t=a;return t})(),C=class{constructor(a="",_=""){this.userName=a,this.password=_}};export{me as LoginComponent};
