import{a as Yt,b as ot,c as at,d as Ht,e as Gt,f as rt}from"./chunk-SU7AERC3.js";import{a as Lt}from"./chunk-3W36CHB7.js";import{a as z}from"./chunk-4ZW7E4TV.js";import{a as k}from"./chunk-5M2JJTQ6.js";import"./chunk-7SKX3N7G.js";import{a as At}from"./chunk-6RLZW4T7.js";import{a as et}from"./chunk-VSHXB745.js";import{a as St,b as bt}from"./chunk-5Z56B3SQ.js";import{p as Mt}from"./chunk-BS35BKX7.js";import{a as it,c as nt,d as qt,f as Bt}from"./chunk-S3WVO4RX.js";import{a as P}from"./chunk-K4J65KC6.js";import{b as X,c as tt}from"./chunk-46C5OQ3F.js";import{a as K,b as Z,c as Ut,f as W,g as J}from"./chunk-X7YUYQ54.js";import"./chunk-FSERETJE.js";import"./chunk-F4DSFHW7.js";import{a as jt}from"./chunk-TPP4GMFL.js";import"./chunk-CHGDWI4X.js";import"./chunk-66AFA25Q.js";import{b as L,g as Y,h as Et,i as wt,j as H,k as Tt,p as G,r as Dt,s as kt,t as Q,u as $}from"./chunk-WYGIYYQO.js";import"./chunk-5HCI3JVT.js";import{a as g,c as B}from"./chunk-RL25V5BE.js";import{a as Rt,b as It,d as Nt,f as Vt,g as Ot,k as Ft}from"./chunk-OMHRRS7A.js";import{b as N,c as M}from"./chunk-OG5DQ5VQ.js";import{a as T,b as D}from"./chunk-RQKRTOUM.js";import{g as Pt,h as y,j as A}from"./chunk-OLDPWYQ6.js";import"./chunk-SUU2CJAS.js";import{o as q}from"./chunk-LVLQ6W55.js";import{Ab as xt,Bc as o,Cc as F,Db as ct,Dc as V,Ea as ut,La as ft,Mc as O,Pc as U,Qb as c,Rb as d,Rc as j,Tb as Ct,Ub as ht,Vb as v,Wb as n,Wc as vt,Xb as i,Yb as S,_c as yt,bd as b,ec as C,fb as _t,jb as s,jc as u,l as pt,ma as m,mc as p,rb as gt,sa as f,ta as _,wc as I,ya as w,yb as x}from"./chunk-JOM6ROGP.js";function ne(t,l){if(t&1&&S(0,"img",10),t&2){let e,a=p();v("src","data:image/png;base64,"+((e=a.qrCodeData())==null?null:e.data),_t)}}function oe(t,l){t&1&&S(0,"mat-spinner",11)}function ae(t,l){t&1&&(n(0,"mat-error")(1,"p"),o(2,"Enter a valid 6-digit code."),i()())}var Qt=(()=>{class t{constructor(){this.destroyRef=m(w),this.dialogRef=m(it),this.myAccountService=m(P),this.notificationService=m(et),this.qrCodeData=B(this.myAccountService.generateNewQRCode())}activate(e){if(e.valid&&this.qrCodeData()?.secretKey){let a={secretKey:this.qrCodeData().secretKey,code:e.value};this.myAccountService.activateTotp(a).pipe(g(this.destroyRef)).subscribe({next:r=>this.onSuccess(),error:r=>this.notificationService.showError("Code Invalid")})}}onSuccess(){this.notificationService.showSuccess("2FA activated successfully"),this.dialogRef.close(!0)}cancelActivation(){this.dialogRef.close(!1)}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-totp-activation"]],decls:66,vars:3,consts:[["totpCode","ngModel"],[1,"card","border","rounded-lg","shadow-md","pb-4"],[1,"card-header","text-lg","fw-bold","p-5","bg-primary-text"],[1,"card-body"],["expanded",""],[1,"text-sm"],["href","https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en","target","_blank",1,"text-primary","font-bold","underline"],["href","https://www.microsoft.com/en-us/security/mobile-authenticator-app","target","_blank",1,"text-primary","font-bold","underline"],["href","https://authy.com/download/","target","_blank",1,"text-primary","font-bold","underline"],[1,"qr-code-section","flex","justify-center","items-center","mt-4"],["id","qrCode","alt","QR Code",1,"w-48","h-48",3,"src"],["diameter","40"],[1,"secret-key-section","text-center","mt-4"],[1,"font-medium","text-primary","text-sm"],[1,"mt-3"],[1,"w-full"],["matInput","","type","text","inputmode","number","id","totpCode","name","totpCode","aria-label","6 Digit TOTP Code","aria-describedby","totpCodeLabel","autocomplete","off","ngModel","","required","","pattern","[0-9]{6}","maxlength","6",1,"rounded-lg","w-full"],[1,"flex","gap-2","mt-4","justify-end"],["mat-flat-button","","type","button",3,"click"],["mat-stroked-button","","type","button",3,"click"]],template:function(a,r){if(a&1){let h=C();n(0,"div",1)(1,"div",2),o(2," Two-Factor Authentication (2FA) - TOTP Activation "),i(),n(3,"div",3)(4,"mat-expansion-panel",4)(5,"mat-expansion-panel-header")(6,"mat-panel-title"),o(7," Step 1: Install an Authenticator App "),i()(),n(8,"p"),o(9," To use 2FA, you will need an authenticator app installed on your mobile device. If you don\u2019t already have one, download one of these apps: "),i(),n(10,"ol",5)(11,"li")(12,"a",6),o(13,"Google Authenticator (iOS and Android)"),i()(),n(14,"li")(15,"a",7),o(16,"Microsoft Authenticator (iOS and Android)"),i()(),n(17,"li")(18,"a",8),o(19," Authy (iOS and Android)"),i()()()(),n(20,"mat-expansion-panel",4)(21,"mat-expansion-panel-header")(22,"mat-panel-title"),o(23," Step 2: Scan the QR Code "),i()(),n(24,"ol",5)(25,"li"),o(26,"Open your authenticator app."),i(),n(27,"li"),o(28,'Tap the "+" icon to add a new account.'),i(),n(29,"li"),o(30,"Select the option to scan a QR code."),i(),n(31,"li"),o(32,"Scan the QR code displayed below using your app."),i()(),n(33,"div",9),c(34,ne,1,1,"img",10)(35,oe,1,0,"mat-spinner",11),i(),n(36,"div",12)(37,"p",13),o(38," Or enter the key manually: "),n(39,"strong"),o(40),i()()()(),n(41,"mat-expansion-panel",4)(42,"mat-expansion-panel-header")(43,"mat-panel-title"),o(44," Step 3: Confirm the Verification Code "),i()(),n(45,"ol",5)(46,"li"),o(47,"After scanning the QR code, your authenticator app will generate a 6-digit verification code."),i(),n(48,"li"),o(49,"Enter the 6-digit code in the field below to activate 2FA."),i(),n(50,"li"),o(51,'Click the "Activate" button to complete the process.'),i(),n(52,"li"),o(53,"You\u2019ll receive a confirmation message once 2FA is successfully activated."),i()(),n(54,"div",14)(55,"mat-form-field",15)(56,"mat-label"),o(57,"Code"),i(),S(58,"input",16,0),c(60,ae,3,0,"mat-error"),i()(),n(61,"div",17)(62,"button",18),u("click",function(){f(h);let Jt=I(59);return _(r.activate(Jt))}),o(63,"Activate"),i(),n(64,"button",19),u("click",function(){return f(h),_(r.cancelActivation())}),o(65,"Cancel"),i()()()()()}if(a&2){let h,E=I(59);s(34),d(r.qrCodeData()?34:35),s(6),F((h=r.qrCodeData())==null?null:h.secretKey),s(20),d(E.invalid&&E.touched?60:-1)}},dependencies:[$,L,Y,G,kt,Q,H,bt,St,rt,ot,at,Ht,A,y,J,W,K,Z,tt,X],styles:[".card-body[_ngcontent-%COMP%]{max-height:90vh;overflow:scroll}mat-expansion-panel[_ngcontent-%COMP%]{margin:.5rem 0}"],changeDetection:0})}}return t})();var st=(()=>{class t{constructor(){this.roles=yt.required({alias:"appDisableIfNoRoleExists"}),this.el=m(ft),this.renderer=m(gt),this.authService=m(M)}ngOnInit(){this.checkRoleAndDisableIfRequired()}checkRoleAndDisableIfRequired(){this.authService.hasAnyRole(this.roles())?(this.renderer.setProperty(this.el.nativeElement,"disabled",!1),this.renderer.setAttribute(this.el.nativeElement,"disabled","false"),this.el.nativeElement.disabled=!1):(this.renderer.setProperty(this.el.nativeElement,"disabled",!0),this.renderer.setAttribute(this.el.nativeElement,"disabled","true"),this.el.nativeElement.disabled=!0)}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275dir=xt({type:t,selectors:[["","appDisableIfNoRoleExists",""]],inputs:{roles:[1,"appDisableIfNoRoleExists","roles"]}})}}return t})();var lt=(()=>{class t{constructor(){this.dialogRef=m(it)}confirmAction(){this.dialogRef.close(!0)}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-confirmation-dialog"]],decls:17,vars:0,consts:[[1,"confirmation-card","shadow-lg","rounded-xl","border","border-primary"],[1,"text-primary"],[1,"!py-5"],[1,"text-sm","text-red-600","font-medium","mt-2"],["align","end",1,"gap-2","py-4"],["mat-flat-button","","type","button",3,"click"],["mat-stroked-button","","type","button","mat-dialog-close","false"]],template:function(a,r){a&1&&(n(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title",1),o(3,"Confirmation Required"),i()(),n(4,"mat-card-content",2)(5,"p",1),o(6,"Are you sure you want to proceed with this action?"),i(),n(7,"p",3),o(8," This action "),n(9,"strong"),o(10,"cannot be undone"),i(),o(11,". "),i()(),n(12,"mat-card-actions",4)(13,"button",5),u("click",function(){return r.confirmAction()}),o(14,"Confirm"),i(),n(15,"button",6),o(16,"Cancel"),i()()())},dependencies:[qt,y,Ft,Rt,Vt,Nt,Ot,It],encapsulation:2,changeDetection:0})}}return t})();var $t=t=>[t];function se(t,l){t&1&&(n(0,"span",3)(1,"mat-icon"),o(2,"check_circle"),i(),o(3," Activated "),i())}function le(t,l){t&1&&(n(0,"span",4)(1,"mat-icon"),o(2,"error"),i(),o(3," Not Activated "),i())}function ce(t,l){if(t&1){let e=C();n(0,"button",8),u("click",function(){f(e);let r=p(3);return _(r.setupTotp())}),o(1," Activate "),i()}}function de(t,l){t&1&&(n(0,"div")(1,"p",9),o(2,"You do have access to activate/deactivate TOTP for the account."),i()())}function me(t,l){if(t&1&&(n(0,"div",5),c(1,ce,2,0,"button",7),c(2,de,3,0,"div"),i()),t&2){let e=p(2);s(),d(e.authService.hasAuthenticatedRole()?1:-1),s(),d(e.authService.hasAuthenticatedRole()?-1:2)}}function pe(t,l){if(t&1){let e=C();n(0,"div",6)(1,"button",10),u("click",function(){f(e);let r=p(2);return _(r.confirmTotpDeactivation())}),o(2," Deactivate "),i(),n(3,"button",11),u("click",function(){f(e);let r=p(2);return _(r.testCode())}),o(4," Test "),i()()}if(t&2){let e=p(2);s(),v("appDisableIfNoRoleExists",O(2,$t,e.Role.AUTHENTICATED_USER)),s(2),v("appDisableIfNoRoleExists",O(4,$t,e.Role.AUTHENTICATED_USER))}}function ue(t,l){if(t&1&&(n(0,"section",0)(1,"div",1)(2,"h4",2),o(3,"Authenticator TOTP"),i(),n(4,"div"),c(5,se,4,0,"span",3)(6,le,4,0,"span",4),i()(),c(7,me,3,2,"div",5),c(8,pe,5,6,"div",6),i()),t&2){let e=p();s(5),d(e.isTotpActive()?5:6),s(2),d(e.isTotpActive()?-1:7),s(),d(e.isTotpActive()?8:-1)}}var zt=(()=>{class t{constructor(){this.destroyRef=m(w),this.dialog=m(nt),this.myAccountService=m(P),this.authService=m(M),this.isTotpActive=b(!1),this.isLoadingCompleted=b(!1),this.Role=N}setupTotp(){this.dialog.open(Qt,{disableClose:!0}).afterClosed().pipe(g(this.destroyRef)).subscribe(a=>{this.getCurrentTotpStatus()})}ngOnInit(){this.getCurrentTotpStatus()}getCurrentTotpStatus(){this.myAccountService.getTotpStatus().pipe(g(this.destroyRef)).subscribe({next:e=>{this.isTotpActive.set(e.active),this.isLoadingCompleted.set(!0)},error:e=>{console.log(e),this.isLoadingCompleted.set(!0)}})}testCode(){this.dialog.open(Bt,{disableClose:!0}).afterClosed().pipe(g(this.destroyRef)).subscribe(a=>{console.log("Result:",a)})}confirmTotpDeactivation(){this.dialog.open(lt,{disableClose:!0}).afterClosed().pipe(g(this.destroyRef)).subscribe(a=>{a===!0&&this.deactivateTotp()})}deactivateTotp(){this.myAccountService.deactivateTotp().pipe(g(this.destroyRef)).subscribe({next:e=>this.getCurrentTotpStatus(),error:e=>console.log(e)})}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-my-totp-settings"]],inputs:{isTotpActive:[1,"isTotpActive"],isLoadingCompleted:[1,"isLoadingCompleted"]},outputs:{isTotpActive:"isTotpActiveChange",isLoadingCompleted:"isLoadingCompletedChange"},decls:1,vars:1,consts:[[1,"container","mx-auto","mt-4","p-6","border","border-black/50","dark:border-white/50","rounded-lg","shadow-lg","flex","flex-col"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-primary","text-lg","font-bold"],["matTooltip","Activated",1,"text-success","flex","items-center","gap-1","text-sm"],["matTooltip","Not Activated",1,"text-danger","flex","items-center","gap-1","text-sm"],[1,"flex","justify-start"],[1,"flex","gap-2","mt-4"],["mat-flat-button","","type","button"],["mat-flat-button","","type","button",3,"click"],[1,"text-sm","text-primary","italic"],["mat-button","","type","button",3,"click","appDisableIfNoRoleExists"],["mat-stroked-button","","type","button",3,"click","appDisableIfNoRoleExists"]],template:function(a,r){a&1&&c(0,ue,9,3,"section",0),a&2&&d(r.isLoadingCompleted()?0:-1)},dependencies:[st,z,k,D,T,A,y],encapsulation:2,changeDetection:0})}}return t})();var fe=t=>[t];function _e(t,l){t&1&&(n(0,"span",4)(1,"mat-icon"),o(2,"check_circle"),i(),o(3," Activated "),i())}function ge(t,l){t&1&&(n(0,"span",5)(1,"mat-icon"),o(2,"error"),i(),o(3," Not Activated "),i())}function xe(t,l){t&1&&(n(0,"div",6)(1,"p",8),o(2," Multi-Factor Authentication activation requires one of the following security measures to be enabled or verified: "),i(),n(3,"ul",9)(4,"li"),o(5,"Email Address"),i(),n(6,"li"),o(7,"TOTP (Time-Based One-Time Password)"),i()()())}function Ce(t,l){if(t&1){let e=C();n(0,"button",12),u("click",function(){f(e);let r=p(3);return _(r.enableMfa())}),o(1," Activate "),i()}}function he(t,l){t&1&&(n(0,"div")(1,"p",13),o(2,"You do have access to activate/deactivate Multi-Factor authentication for the account."),i()())}function ve(t,l){t&1&&(n(0,"p",11),o(1," Unable to activate MFA. Please check prerequisite conditions before activating MFA. "),i())}function ye(t,l){if(t&1&&(n(0,"div",7),c(1,Ce,2,0,"button",10)(2,he,3,0,"div"),c(3,ve,2,0,"p",11),i()),t&2){let e=p(2);s(),d(e.authService.hasAuthenticatedRole()?1:2),s(2),d(e.isErrorOccurred()?3:-1)}}function Se(t,l){t&1&&(n(0,"p",11),o(1," Unable to deactivate MFA. Please try again later. "),i())}function be(t,l){if(t&1){let e=C();n(0,"div",7)(1,"div",14)(2,"button",15),u("click",function(){f(e);let r=p(2);return _(r.confirmMfaDeactivation())}),o(3,"Deactivate "),i()(),c(4,Se,2,0,"p",11),i()}if(t&2){let e=p(2);s(2),v("appDisableIfNoRoleExists",O(2,fe,e.Role.AUTHENTICATED_USER)),s(2),d(e.isErrorOccurred()?4:-1)}}function Me(t,l){if(t&1&&(n(0,"section",0)(1,"div",1)(2,"h4",2),o(3,"Multi-Factor Authentication"),i(),n(4,"div",3),c(5,_e,4,0,"span",4)(6,ge,4,0,"span",5),i()(),c(7,xe,8,0,"div",6),c(8,ye,4,2,"div",7),c(9,be,5,4,"div",7),i()),t&2){let e,a,r,h,E=p();s(5),d((e=E.userData())!=null&&e.mfaEnabled?5:6),s(2),d((a=E.userData())!=null&&a.mfaEnabled?-1:7),s(),d((r=E.userData())!=null&&r.mfaEnabled?-1:8),s(),d((h=E.userData())!=null&&h.mfaEnabled?9:-1)}}var Kt=(()=>{class t{constructor(){this.Role=N,this.destroyRef=m(w),this.dialog=m(nt),this.myAccountService=m(P),this.authService=m(M),this.userData=b(),this.isErrorOccurred=b(!0)}ngOnInit(){this.fetchCurrentUserData()}fetchCurrentUserData(){this.myAccountService.getProfileData().pipe(g(this.destroyRef)).subscribe({next:e=>{this.userData.set(e),this.isErrorOccurred.set(!1)},error:e=>console.log(e)})}enableMfa(){this.changeMfa(!0)}confirmMfaDeactivation(){this.dialog.open(lt,{disableClose:!0}).afterClosed().pipe(g(this.destroyRef)).subscribe(a=>{a===!0&&this.changeMfa(!1)})}changeMfa(e){this.myAccountService.changeMfaStatus(e).pipe(g(this.destroyRef)).subscribe({next:a=>this.fetchCurrentUserData(),error:a=>{console.log(a),this.isErrorOccurred.set(!0)}})}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-my-mfa-settings"]],inputs:{userData:[1,"userData"],isErrorOccurred:[1,"isErrorOccurred"]},outputs:{userData:"userDataChange",isErrorOccurred:"isErrorOccurredChange"},decls:1,vars:1,consts:[[1,"container","mx-auto","mt-4","p-6","border","border-black/50","dark:border-white/50","rounded-lg","shadow-lg","flex","flex-col"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-primary","text-lg","font-bold"],[1,"status-badge","flex","items-center","ml-3"],["matTooltip","Activated",1,"text-success","flex","items-center","gap-1","text-sm"],["matTooltip","Not Activated",1,"text-danger","flex","items-center","gap-1","text-sm"],[1,"text-primary","text-sm","font-medium","mb-4"],[1,"flex","flex-col"],[1,"mb-2"],[1,"list-disc","pl-5"],["mat-flat-button","","type","button",1,"w-max"],[1,"text-danger","text-sm","font-bold","mt-2"],["mat-flat-button","","type","button",1,"w-max",3,"click"],[1,"text-sm","text-primary","italic"],[1,"flex","gap-2"],["mat-button","","type","button",1,"w-max",3,"click","appDisableIfNoRoleExists"]],template:function(a,r){a&1&&c(0,Me,10,4,"section",0),a&2&&d(r.userData()?0:-1)},dependencies:[st,k,D,T,A,y],encapsulation:2,changeDetection:0})}}return t})();function Ee(t,l){t&1&&(n(0,"span",5)(1,"mat-icon"),o(2,"check_circle"),i(),o(3," Compliant "),i())}function we(t,l){t&1&&(n(0,"span",6)(1,"mat-icon"),o(2,"error"),i(),o(3," Non-Compliant "),i())}function Te(t,l){if(t&1&&(n(0,"p"),o(1," Current Password Changed at "),n(2,"span",8),o(3),U(4,"date"),i()()),t&2){let e,a=p(2);s(3),V(" ",j(4,1,(e=a.userData())==null?null:e.passwordChangedAt,"dd.MM.yyyy h:mm:ss a z")," ")}}function De(t,l){if(t&1){let e=C();n(0,"button",10),u("click",function(){f(e);let r=p(3);return _(r.editMode.set(!0))}),o(1," Change Password "),i()}}function ke(t,l){t&1&&(n(0,"div")(1,"p",11),o(2,"You do have access to change password for the account."),i()())}function Ae(t,l){if(t&1&&(n(0,"div"),c(1,De,2,0,"button",9),c(2,ke,3,0,"div"),i()),t&2){let e=p(2);s(),d(e.authService.hasAuthenticatedRole()?1:-1),s(),d(e.authService.hasAuthenticatedRole()?-1:2)}}function Pe(t,l){t&1&&(n(0,"mat-error"),o(1," Password must be 8-50 characters long, include uppercase, lowercase, number, and special character. "),i())}function Re(t,l){t&1&&(n(0,"div",18),o(1," Invalid Password. Valid Password should contain at least one lowercase letter, one uppercase letter, one digit, one special character, and be 8 to 50 characters long. "),i())}function Ie(t,l){if(t&1){let e=C();n(0,"div")(1,"form",12),u("ngSubmit",function(){f(e);let r=I(9),h=p(2);return _(h.savePassword(r))}),S(2,"input",13,0),n(4,"div",14)(5,"mat-form-field",15)(6,"mat-label"),o(7,"New Password"),i(),S(8,"input",16,1),n(10,"button",17),u("click",function(){f(e);let r=p(2);return _(r.togglePasswordVisibility())}),n(11,"mat-icon"),o(12),i()(),c(13,Pe,2,0,"mat-error"),i()(),c(14,Re,2,0,"div",18),n(15,"div",19)(16,"button",20),u("click",function(){f(e);let r=p(2);return _(r.editMode.set(!1))}),o(17,"Cancel"),i(),n(18,"button",21),o(19,"Save"),i()()()()}if(t&2){let e=I(9),a=p(2);s(2),v("hidden",!0)("ngModel",a.userData().username),s(6),v("type",a.showPassword()?"text":"password"),s(4),F(a.showPassword()?"visibility_off":"visibility"),s(),d(e.invalid&&e.touched?13:-1),s(),d(a.isErrorOccurred()?14:-1),s(4),v("disabled",e.invalid)}}function Ne(t,l){if(t&1&&(n(0,"section",2)(1,"div",3)(2,"h4",4),o(3,"Password"),i(),n(4,"div"),c(5,Ee,4,0,"span",5)(6,we,4,0,"span",6),i()(),n(7,"div",7)(8,"p"),o(9,"We recommend changing your password at least every 3 months to enhance the security of your account."),i(),c(10,Te,5,4,"p"),i(),c(11,Ae,3,2,"div"),c(12,Ie,20,7,"div"),i()),t&2){let e,a=p();s(5),d(a.isPasswordComplaint()?5:6),s(5),d((e=a.userData())!=null&&e.passwordChangedAt?10:-1),s(),d(a.editMode()?-1:11),s(),d(a.editMode()&&a.userData()?12:-1)}}var Zt=(()=>{class t{constructor(){this.destroyRef=m(w),this.myAccountService=m(P),this.authService=m(M),this.userData=b(),this.isErrorOccurred=b(!0),this.editMode=b(!1),this.showPassword=ut(!1),this.Role=N}ngOnInit(){this.fetchCurrentUserData()}fetchCurrentUserData(){this.myAccountService.getProfileData().pipe(g(this.destroyRef)).subscribe({next:e=>{this.userData.set(e),this.isErrorOccurred.set(!1),this.editMode.set(!1)},error:e=>console.log(e)})}savePassword(e){e.valid?this.myAccountService.changePassword(e.value).pipe(g(this.destroyRef)).subscribe({next:a=>this.fetchCurrentUserData(),error:a=>{console.log(a),this.isErrorOccurred.set(!0)}}):this.isErrorOccurred.set(!0)}isPasswordComplaint(){return this.userData()?.passwordChangedAt?new Date().getFullYear()-new Date(Date.parse(this.userData().passwordChangedAt)).getFullYear()*12<=3:!1}togglePasswordVisibility(){this.showPassword.update(e=>!e)}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-my-password-settings"]],inputs:{userData:[1,"userData"],isErrorOccurred:[1,"isErrorOccurred"],editMode:[1,"editMode"]},outputs:{userData:"userDataChange",isErrorOccurred:"isErrorOccurredChange",editMode:"editModeChange"},decls:1,vars:1,consts:[["username","ngModel"],["newPassword","ngModel"],[1,"container","mx-auto","mt-4","p-6","border","border-black/50","dark:border-white/50","shadow-lg","rounded-lg","shadow-lg"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-primary","text-lg","font-bold"],["matTooltip","Compliant",1,"text-success","flex","items-center","gap-1","text-sm"],["matTooltip","Non-Compliant",1,"text-danger","flex","items-center","gap-1","text-sm"],[1,"text-primary","text-sm","mb-4","flex","flex-col","gap-2"],[1,"font-bold","underline"],["mat-flat-button","","type","button"],["mat-flat-button","","type","button",3,"click"],[1,"text-sm","text-primary","italic"],[1,"flex","flex-col","gap-2",3,"ngSubmit"],["type","email","name","username","id","username","required","","placeholder","Username","autocomplete","username",3,"hidden","ngModel"],[1,"relative"],[1,"w-full"],["matInput","","type","password","id","newPassword","name","newPassword","ngModel","","autocomplete","new-password","required","","minlength","8","pattern","^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@.#$!%*?&^])[A-Za-z\\d@.#$!%*?&]{8,50}$",3,"type"],["mat-icon-button","","type","button","matSuffix","",3,"click"],[1,"text-danger","text-sm","font-bold"],[1,"flex","justify-end","gap-2"],["mat-stroked-button","","type","button",3,"click"],["mat-raised-button","","type","submit",3,"disabled"]],template:function(a,r){a&1&&c(0,Ne,13,4,"section",2),a&2&&d(r.userData()?0:-1)},dependencies:[$,Tt,L,Y,Et,G,Dt,Q,H,wt,k,J,W,K,Z,Ut,D,T,A,y,Pt,tt,X,q],encapsulation:2,changeDetection:0})}}return t})();var Ve=(t,l)=>l.credentialId;function Oe(t,l){t&1&&(n(0,"span",3)(1,"mat-icon"),o(2,"check_circle"),i(),o(3," Activated "),i())}function Fe(t,l){t&1&&(n(0,"span",4)(1,"mat-icon"),o(2,"error"),i(),o(3," Not Activated "),i())}function Ue(t,l){if(t&1){let e=C();n(0,"button",8),u("click",function(){f(e);let r=p();return _(r.registerNewPasskey())}),o(1," Register New Passkey "),i()}}function je(t,l){if(t&1){let e=C();n(0,"tr")(1,"td",16),o(2),i(),n(3,"td",17),o(4),U(5,"date"),i(),n(6,"td",18)(7,"button",19),u("click",function(){let r=f(e).$implicit,h=p(3);return _(h.removePasskey(r.credentialId))}),o(8,"Remove "),i()()()}if(t&2){let e=l.$implicit;s(2),V("",e.deviceInfo," "),s(2),V("",j(5,2,e.createdAt,"long")," ")}}function qe(t,l){if(t&1&&(n(0,"table",11)(1,"thead",12)(2,"tr")(3,"th",13),o(4,"Name"),i(),n(5,"th",13),o(6,"Registered At "),i(),n(7,"th",14),o(8,"Action"),i()()(),n(9,"tbody",15),Ct(10,je,9,5,"tr",null,Ve),i()()),t&2){let e=p(2);s(10),ht(e.registeredPasskeys())}}function Be(t,l){t&1&&(n(0,"div",7)(1,"mat-accordion")(2,"mat-expansion-panel")(3,"mat-expansion-panel-header")(4,"h5",9),o(5,"Registered Passkeys"),i()(),ct(6,qe,12,0,"ng-template",10),i()()())}function Le(t,l){t&1&&(n(0,"div")(1,"p",20),o(2,"You do have access to register Passkey for the account."),i()())}var Wt=(()=>{class t{constructor(){this.authService=m(M),this.passkeyService=m(jt),this.notificationService=m(et),this.passkeysSubject=new pt([]),this.registeredPasskeys=B(this.passkeysSubject.asObservable(),{initialValue:[]}),this.isPasskeyExists=vt(()=>this.registeredPasskeys().length>0),this.list()}list(){this.passkeyService.list().subscribe({next:e=>{console.log("Retrieved passkeys:",e),this.passkeysSubject.next(e)},error:e=>{console.error("Error retrieving passkeys:",e),this.notificationService.showError("Error retrieving passkeys: "+e.message)}})}registerNewPasskey(){this.passkeyService.register().subscribe({next:()=>{this.notificationService.showSuccess("Registration completed successfully!"),this.list()},error:e=>this.notificationService.showError("Error during registration:"+e.message)})}removePasskey(e){console.log("Removing passkey with ID:",e),this.passkeyService.remove(e).subscribe({next:()=>{this.notificationService.showSuccess("Passkey removed successfully!"),this.list()},error:a=>this.notificationService.showError("Error removing passkey: "+a.message)})}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-my-passkey-settings"]],decls:11,vars:3,consts:[[1,"container","mx-auto","mt-4","p-6","border","border-black/50","dark:border-white/50","rounded-lg","shadow-lg","flex","flex-col"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-primary","text-lg","font-bold"],["matTooltip","Activated",1,"text-success","flex","items-center","gap-1","text-sm"],["matTooltip","Not Activated",1,"text-danger","flex","items-center","gap-1","text-sm"],[1,"flex","justify-start"],["mat-flat-button","","type","button",3,"click",4,"appHasAuthenticated"],[1,"mt-4"],["mat-flat-button","","type","button",3,"click"],[1,"text-md","font-semibold","mb-2"],["matExpansionPanelContent",""],[1,"min-w-full","divide-y","divide-gray-200","border","rounded-lg","overflow-hidden"],[1,"bg-gray-50","dark:bg-gray-800"],[1,"px-4","py-2","text-left","text-sm","font-semibold","text-gray-700","dark:text-gray-300"],[1,"px-4","py-2","text-sm","font-semibold","text-gray-700","dark:text-gray-300"],[1,"divide-y","divide-gray-100","dark:divide-gray-700","bg-white","dark:bg-gray-900"],[1,"px-4","py-2","font-mono","text-sm","text-gray-900","dark:text-gray-200"],[1,"px-4","py-2","font-mono","text-sm","text-gray-500","dark:text-gray-400"],[1,"px-4","py-2","text-right"],["mat-button","","type","button",1,"text-red-600","hover:text-red-800","text-sm","font-medium",3,"click"],[1,"text-sm","text-primary","italic"]],template:function(a,r){a&1&&(n(0,"section",0)(1,"div",1)(2,"h4",2),o(3,"Passkey"),i(),n(4,"div"),c(5,Oe,4,0,"span",3)(6,Fe,4,0,"span",4),i()(),n(7,"div",5),ct(8,Ue,2,0,"button",6),i(),c(9,Be,7,0,"div",7),c(10,Le,3,0,"div"),i()),a&2&&(s(5),d(r.isPasskeyExists()?5:6),s(4),d(r.isPasskeyExists()?9:-1),s(),d(r.authService.hasAuthenticatedRole()?-1:10))},dependencies:[D,T,z,k,y,Gt,rt,ot,at,Yt,At,q],encapsulation:2})}}return t})();var Dn=(()=>{class t{constructor(){this.MY_SECURITY_SETTINGS_PAGE_INFO=Mt}static{this.\u0275fac=function(a){return new(a||t)}}static{this.\u0275cmp=x({type:t,selectors:[["app-my-account-settings-page"]],decls:8,vars:1,consts:[[3,"pageInfo"],[1,"flex","flex-col"]],template:function(a,r){a&1&&(n(0,"header"),S(1,"app-page-header",0),i(),n(2,"main")(3,"div",1),S(4,"app-my-passkey-settings")(5,"app-my-password-settings")(6,"app-my-totp-settings")(7,"app-my-mfa-settings"),i()()),a&2&&(s(),v("pageInfo",r.MY_SECURITY_SETTINGS_PAGE_INFO))},dependencies:[Lt,zt,Kt,Zt,Wt],encapsulation:2,changeDetection:0})}}return t})();export{Dn as MyAccountSettingsPageComponent};
