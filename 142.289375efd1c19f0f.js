"use strict";(self.webpackChunkjourney=self.webpackChunkjourney||[]).push([[142],{7142:(C,d,o)=>{o.r(d),o.d(d,{DashboardComponent:()=>c});var y=o(676),a=o(8722),l=o(4016),_=o(177),e=o(4438),h=o(7404);const v=(i,p)=>p[0];function t(i,p){if(1&i&&(e.j41(0,"div",8)(1,"span",9),e.EFF(2),e.k0s(),e.j41(3,"div",10),e.EFF(4),e.k0s()()),2&i){const s=p.$implicit;e.R7$(2),e.JRh(s[1]),e.R7$(2),e.JRh(s[0])}}function r(i,p){if(1&i&&(e.j41(0,"div",7),e.Z7z(1,t,5,2,"div",8,v),e.k0s()),2&i){const s=e.XpG();e.R7$(),e.Dyx(s.stats.entries())}}let c=(()=>{class i{constructor(s){this.journeyService=s,this.DASHBOARD_PAGE_INFO=y.aY,this.stats=new Map}ngOnInit(){this.journeyService.getAllJourneysAsGeoJson().subscribe(s=>this.onFetchSuccessCallback(s))}onFetchSuccessCallback(s){this.featureCollection=s,this.collectStats(s)}collectStats(s){this.stats.set("Journeys",s.features.length),this.stats.set("Places",this.uniqueJourneysByProperty(s,"location")),this.stats.set("Country",this.uniqueJourneysByProperty(s,"country")),this.stats.set("City",this.uniqueJourneysByProperty(s,"city"))}uniqueJourneysByProperty(s,u){return s.features.filter(n=>n.properties?.[u]).filter((n,g,j)=>j.findIndex(A=>JSON.stringify(A.properties?.[u])===JSON.stringify(n.properties?.[u]))===g).length}static#e=this.\u0275fac=function(u){return new(u||i)(e.rXU(h.K))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[e.aNF],decls:7,vars:3,consts:[[3,"pageInfo"],[1,"container"],[1,"row","mb-2"],["class","col-12 d-flex gap-2 flex-wrap justify-content-center align-content-center",4,"ngIf"],[1,"row"],[1,"col",2,"position","relative","height","70vh"],["enablePopup","true",3,"geoJsonData"],[1,"col-12","d-flex","gap-2","flex-wrap","justify-content-center","align-content-center"],[1,"text-center","border","border-primary","border-2","rounded","rounded-2","p-2",2,"min-width","75px"],[1,"fs-3","gradient-text","text-primary","fw-bold"],[1,"small","gradient-text"]],template:function(u,n){1&u&&(e.nrm(0,"app-page-header",0),e.j41(1,"section",1)(2,"div",2),e.DNE(3,r,3,0,"div",3),e.k0s(),e.j41(4,"div",4)(5,"div",5),e.nrm(6,"app-world-map",6),e.k0s()()()),2&u&&(e.Y8G("pageInfo",n.DASHBOARD_PAGE_INFO),e.R7$(3),e.Y8G("ngIf",n.stats),e.R7$(3),e.Y8G("geoJsonData",n.featureCollection))},dependencies:[l.y,a.s,_.bT]})}return i})()},7404:(C,d,o)=>{o.d(d,{K:()=>e});var y=o(1626),a=o(2525),l=o(4438),_=o(4486);let e=(()=>{class h{constructor(t,r){this.httpClient=t,this.authService=r}createJourney(t){let r=this.authService.getCurrentUserContext();return this.httpClient.post(a.c.journeyApi+"/journey",t,{headers:{Authorization:`Bearer ${r.accessToken}`}})}findJourneyByQuery(t,r,c,i,p,s,u=[]){let n=new y.Nl;return n=n.set("q",t),n=n.set("sort",r),n=n.set("order",c.toUpperCase()),n=n.set("pageIndex",i),n=n.set("pageSize",p),n=n.set("publishedOnly",s),n=n.set("tags",u.join(",")),console.log(n),this.getAllJourneys(n)}getAllJourneys(t){let r=this.authService.getCurrentUserContext();return this.httpClient.get(a.c.journeyApi+"/journeys",{params:t,headers:{Authorization:`Bearer ${r.accessToken}`}})}getAllJourneysAsGeoJson(){let t=this.authService.getCurrentUserContext();return this.httpClient.get(a.c.journeyApi+"/journeys/published",{headers:{Accept:"application/geo+json",Authorization:`Bearer ${t.accessToken}`}})}getJourneyById(t){let r=this.authService.getCurrentUserContext();return this.httpClient.get(a.c.journeyApi+"/journey/"+t,{headers:{Authorization:`Bearer ${r.accessToken}`}})}saveJourneyBasicDetails(t){let r=this.authService.getCurrentUserContext();return this.httpClient.put(a.c.journeyApi+"/journey/"+t.id,t,{headers:{"Content-Type":"application/vnd.journey.api.basic.v1+json",Authorization:`Bearer ${r.accessToken}`}})}saveJourneyGeoDetails(t,r){let c=this.authService.getCurrentUserContext();return this.httpClient.put(a.c.journeyApi+"/journey/"+t.id,r,{headers:{"Content-Type":"application/vnd.journey.api.geo.v1+json",Authorization:`Bearer ${c.accessToken}`}})}saveJourneyImagesDetails(t,r){let c=this.authService.getCurrentUserContext();return this.httpClient.put(a.c.journeyApi+"/journey/"+t.id,r,{headers:{"Content-Type":"application/vnd.journey.api.images.v1+json",Authorization:`Bearer ${c.accessToken}`}})}saveJourneyVideosDetails(t,r){let c=this.authService.getCurrentUserContext();return this.httpClient.put(a.c.journeyApi+"/journey/"+t.id,r,{headers:{"Content-Type":"application/vnd.journey.api.videos.v1+json",Authorization:`Bearer ${c.accessToken}`}})}publishJourney(t){let r=this.authService.getCurrentUserContext();return this.httpClient.put(a.c.journeyApi+"/journey/"+t.id,t,{headers:{"Content-Type":"application/vnd.journey.api.publish.v1+json",Authorization:`Bearer ${r.accessToken}`}})}static#e=this.\u0275fac=function(r){return new(r||h)(l.KVO(y.Qq),l.KVO(_.u))};static#t=this.\u0275prov=l.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()}}]);