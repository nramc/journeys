import{a as I}from"./chunk-PFZ7YC43.js";import{a as ne}from"./chunk-EXXTB3G4.js";import{a as P,b as w,c as H,d as oe,e as re}from"./chunk-ALTHJ7YU.js";import{a as A}from"./chunk-4PC4M2WG.js";import"./chunk-OCT2572Q.js";import{a as R}from"./chunk-VSQTGOJW.js";import"./chunk-RRHBB2PL.js";import{a as f}from"./chunk-VXFKOE2P.js";import{a as $}from"./chunk-JYNPUKUN.js";import{o as Z}from"./chunk-MYEHYWQI.js";import{c as V,g as F,j as U,s as O,t as ee,v as te,w as ie,x as q}from"./chunk-7EIYD6IZ.js";import"./chunk-4PTYCNBB.js";import"./chunk-RGNDWIHZ.js";import"./chunk-LHFKDAYA.js";import{c as X}from"./chunk-5DXZ7UWG.js";import"./chunk-ARLEKDS5.js";import{r as D}from"./chunk-42OPBNH4.js";import{Db as W,Eb as E,Ia as x,Ja as b,Lb as v,Nb as d,Qa as T,Sb as M,Wb as r,Xb as i,Yb as u,ac as y,fc as g,hc as p,mb as K,oc as N,pc as a,qb as c,sc as z,tc as B,ua as m,uc as J,wc as S,ya as h,yc as C}from"./chunk-TO7D4NWA.js";var G=class{constructor(o="EMAIL_ADDRESS",s="",n=!0,e=!1,l,_){this.type=o,this.value=s,this.enabled=n,this.verified=e,this.creationDate=l,this.lastUpdateDate=_}};var j=t=>[t];function ue(t,o){t&1&&(r(0,"span",10),u(1,"i",15),a(2," Verified"),i())}function fe(t,o){t&1&&(r(0,"span",11),u(1,"i",16),a(2," Not Verified"),i())}function ge(t,o){if(t&1){let s=y();r(0,"button",17),g("click",function(){x(s);let e=p(2);return b(e.verifyEmailAddress())}),a(1," Verify Now "),i()}if(t&2){let s=p(2);d("disableIfNoRoleExists",C(1,j,s.Role.AUTHENTICATED_USER))}}function xe(t,o){if(t&1){let s=y();r(0,"div",6)(1,"div",7)(2,"div")(3,"span",8),a(4,"Primary:"),i(),u(5,"span",9),i(),v(6,ue,3,0,"span",10)(7,fe,3,0,"span",11),i(),r(8,"div",12),v(9,ge,2,3,"button",13),r(10,"button",14),g("click",function(){x(s);let e=p();return b(e.enableEdit())}),a(11,"Edit "),i()()()}if(t&2){let s=p();c(5),d("textContent",s.emailAddressData().value),c(),M(s.emailAddressData().verified?6:7),c(3),d("ngIf",s.emailAddressData().value&&!s.emailAddressData().verified),c(),d("disableIfNoRoleExists",C(4,j,s.Role.AUTHENTICATED_USER))}}function be(t,o){if(t&1){let s=y();r(0,"div",18)(1,"div",19)(2,"span",20),a(3,"Primary"),i(),r(4,"input",21,0),J("ngModelChange",function(e){x(s);let l=p();return B(l.emailAddressData().value,e)||(l.emailAddressData().value=e),b(e)}),i(),r(6,"div",22)(7,"button",23),g("click",function(){x(s);let e=N(5),l=p();return b(l.save(e))}),a(8,"Save "),i()()()()}if(t&2){let s=p();c(4),z("ngModel",s.emailAddressData().value),c(3),d("disableIfNoRoleExists",C(2,j,s.Role.AUTHENTICATED_USER))}}var ae=(()=>{let o=class o{constructor(){this.destroyRef=m(T),this.myAccountService=m(A),this.dialog=m(w),this.Role=R,this.emailAddressData=E(new G),this.editModeToggle=E(!1)}ngOnInit(){this.fetchSecurityEmailAddress()}fetchSecurityEmailAddress(){this.myAccountService.getSecurityEmailAddress().pipe(f(this.destroyRef)).subscribe({next:n=>this.onSuccess(n),error:n=>this.onError(n)})}onSuccess(n,e=!1){this.emailAddressData.set(n),this.editModeToggle.set(e)}onError(n){console.log(n)}enableEdit(){this.editModeToggle.set(!0)}save(n){n.validity.valid&&this.editModeToggle()&&this.myAccountService.saveSecurityEmailAddress(n.value).pipe(f(this.destroyRef)).subscribe({next:e=>this.onSuccess(e),error:e=>this.onError(e)})}verifyEmailAddress(){this.dialog.open(re,{disableClose:!0}).afterClosed().subscribe(e=>{this.fetchSecurityEmailAddress()})}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["my-email-address-settings"]],inputs:{emailAddressData:[1,"emailAddressData"],editModeToggle:[1,"editModeToggle"]},outputs:{emailAddressData:"emailAddressDataChange",editModeToggle:"editModeToggleChange"},standalone:!0,features:[S],decls:6,vars:2,consts:[["emailAddressElement",""],[1,"container","d-flex","flex-column","gradient-bg-light-left","mt-2","pt-2","pb-3","border","border-opacity-50","rounded-2","shadow","border-primary"],[1,"col"],[1,"gradient-text"],["class","col-12 d-flex flex-column",4,"ngIf"],["class","col-12",4,"ngIf"],[1,"col-12","d-flex","flex-column"],[1,"col","d-inline-flex","flex-row","text-primary","align-items-center"],[1,"small","pe-2"],[1,"fw-bold","pe-2","fs-6",3,"textContent"],[1,"text-success","border","border-success","border-2","rounded-2","p-1","small","text-nowrap"],[1,"text-danger","border","border-danger","border-2","rounded-2","p-1","small","text-nowrap"],[1,"d-inline-flex","gap-2"],["class","btn btn-success",3,"disableIfNoRoleExists","click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click","disableIfNoRoleExists"],[1,"bi","bi-check-circle-fill"],[1,"bi","bi-exclamation-octagon-fill"],[1,"btn","btn-success",3,"click","disableIfNoRoleExists"],[1,"col-12"],[1,"col","input-group"],[1,"input-group-text","bg-primary","text-light"],["type","email","required","","email","","id","emailAddressElement","name","emailAddressElement",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-text"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click","disableIfNoRoleExists"]],template:function(e,l){e&1&&(r(0,"section",1)(1,"div",2)(2,"h4",3),a(3,"Email Address"),i()(),v(4,xe,12,6,"div",4)(5,be,9,4,"div",5),i()),e&2&&(c(4),d("ngIf",!l.editModeToggle()),c(),d("ngIf",l.editModeToggle()))},dependencies:[q,V,F,O,ee,U,I,D]});let t=o;return t})();var se=(()=>{let o=class o{constructor(){this.feedbackMessage=W({}),this.destroyRef=m(T),this.dialogRef=m(P),this.myAccountService=m(A),this.qrCodeData=E()}ngOnInit(){this.myAccountService.generateNewQRCode().pipe(f(this.destroyRef)).subscribe({next:n=>this.qrCodeData.set(n),error:n=>console.log(n)})}activate(n){if(n.validity.valid&&this.qrCodeData()?.secretKey){let e={secretKey:this.qrCodeData().secretKey,code:n.value};this.myAccountService.activateTotp(e).pipe(f(this.destroyRef)).subscribe({next:l=>this.onSuccess(),error:l=>this.feedbackMessage.set({error:"Code Invalid"})})}}onSuccess(){console.log("2FA TOTP activated"),this.feedbackMessage.set({success:"2FA activated successfully"}),this.dialogRef.close(!0)}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["app-totp-activation"]],inputs:{qrCodeData:[1,"qrCodeData"]},outputs:{qrCodeData:"qrCodeDataChange"},standalone:!0,features:[S],decls:68,vars:3,consts:[["totpCode",""],[1,"card","pb-4"],[1,"card-header","bg-primary","text-light"],[1,"card-body"],[1,"card-text"],[1,"step","step-1"],[1,"d-flex","flex-column"],["data-bs-toggle","collapse","href","#collapseStep1","aria-expanded","true","aria-controls","collapseStep1",1,"col-12","gradient-bg-light","p-2","fs-6","text-decoration-none"],["id","collapseStep1",1,"collapse","show"],[1,"small"],["href","https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en","target","_blank"],["href","https://www.microsoft.com/en-us/security/mobile-authenticator-app","target","_blank"],["href","https://authy.com/download/","target","_blank"],[1,"step","step-2"],["data-bs-toggle","collapse","href","#collapseStep2","aria-expanded","true","aria-controls","collapseStep2",1,"col-12","gradient-bg-light","p-2","fs-6","text-decoration-none"],["id","collapseStep2",1,"collapse","show"],[1,"qr-code-section","text-center"],["id","qrCode","width","200px","height","200px","alt","QR",3,"src"],[1,"secret-key-section","text-center"],[1,"fw-bold","text-primary","small"],[3,"textContent"],[1,"step","step-3"],["data-bs-toggle","collapse","href","#collapseStep3","aria-expanded","true","aria-controls","collapseStep3",1,"col-12","gradient-bg-light","p-2","fs-6","text-decoration-none"],["id","collapseStep3",1,"collapse","show"],[1,"input-group","mb-3"],["id","totpCodeLabel",1,"input-group-text"],["type","text","aria-label","6 Digit TOTP Code","aria-describedby","totpCodeLabel","id","totpCode","name","totpCode","ngModel","","required","","pattern","[0-9]{6,6}","maxlength","6","min","6",1,"form-control"],[1,"error-message"],[3,"message"],[1,"d-inline-flex","gap-2"],["type","button","mat-dialog-close","false",1,"btn","btn-outline-danger"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,l){if(e&1){let _=y();r(0,"div",1)(1,"div",2),a(2," Two-Factor Authentication (2FA) - TOTP Activation "),i(),r(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"a",7),a(8,"Step 1: Install an Authenticator App "),i()(),r(9,"div",8)(10,"p"),a(11,"To use 2FA, you will need an authenticator app installed on your mobile device. If you don\u2019t already have one, you can download one of these apps: "),i(),r(12,"ol",9)(13,"li")(14,"a",10),a(15,"Google Authenticator (iOS and Android)"),i()(),r(16,"li")(17,"a",11),a(18,"Microsoft Authenticator (iOS and Android)"),i()(),r(19,"li")(20,"a",12),a(21,"Authy (iOS and Android)"),i()()()()(),r(22,"div",13)(23,"div",6)(24,"a",14),a(25,"Step 2: Scan the QR Code "),i()(),r(26,"div",15)(27,"ol")(28,"li"),a(29,"Open your authenticator app."),i(),r(30,"li"),a(31,'Select the option to add a new account. This is usually done by tapping the "+" icon.'),i(),r(32,"li"),a(33,"Choose the option to scan a QR code."),i(),r(34,"li"),a(35,"Use your phone\u2019s camera to scan the QR code displayed below."),i()(),r(36,"div",16),u(37,"img",17),i(),r(38,"div",18)(39,"p",19),a(40,"Or enter code manually: "),u(41,"span",20),i()()()(),r(42,"div",21)(43,"div",6)(44,"a",22),a(45,"Step 3: Enter the Verification Code "),i()(),r(46,"div",23)(47,"ol")(48,"li"),a(49,"After scanning the QR code, your authenticator app will display a 6-digit verification code."),i(),r(50,"li"),a(51,"Enter the 6-digit code into the field below to verify and activate 2FA on your account."),i(),r(52,"li"),a(53,'After entering the verification code, click on the "Activate" button below.'),i(),r(54,"li"),a(55,"You will see a confirmation message once 2FA is successfully activated."),i()(),r(56,"div",24)(57,"span",25),a(58,"Code"),i(),u(59,"input",26,0),i(),r(61,"div",27),u(62,"app-feedback-message",28),i(),r(63,"div",29)(64,"button",30),a(65,"Cancel"),i(),r(66,"button",31),g("click",function(){x(_);let pe=N(60);return b(l.activate(pe))}),a(67,"Activate"),i()()()()()()()}if(e&2){let _,Q;c(37),d("src","data:image/png;base64,"+((_=l.qrCodeData())==null?null:_.data),K),c(4),d("textContent",(Q=l.qrCodeData())==null?null:Q.secretKey),c(21),d("message",l.feedbackMessage())}},dependencies:[H,q,V,F,O,te,ie,U,ne],styles:[".card-text[_ngcontent-%COMP%]{max-height:90vh;overflow:scroll}.step[_ngcontent-%COMP%]{margin:.5rem 0}"]});let t=o;return t})();var Y=(()=>{let o=class o{constructor(){this.dialogRef=m(P)}confirmAction(){this.dialogRef.close(!0)}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["app-confirmation-dialog"]],standalone:!0,features:[S],decls:14,vars:0,consts:[[1,"card"],[1,"card-header","bg-primary","text-light"],[1,"card-body"],[1,"card-text"],[1,"text-primary"],[1,"small","fw-bold","text-primary"],[1,"d-inline-flex","gap-2","mt-4"],["mat-dialog-close","false",1,"btn","btn-outline-danger"],[1,"btn","btn-primary",3,"click"]],template:function(e,l){e&1&&(r(0,"div",0)(1,"div",1),a(2," Confirmation Required "),i(),r(3,"div",2)(4,"div",3)(5,"p",4),a(6,"Are you sure you want to proceed with this action?"),i(),r(7,"p",5),a(8,"This action cannot be undone."),i()(),r(9,"div",6)(10,"button",7),a(11,"Cancel"),i(),r(12,"button",8),g("click",function(){return l.confirmAction()}),a(13,"Confirm"),i()()()())},dependencies:[H]});let t=o;return t})();var L=t=>[t];function ve(t,o){t&1&&(r(0,"span",4),u(1,"i",8),a(2," Activated"),i())}function _e(t,o){t&1&&(r(0,"span",5),u(1,"i",9),a(2," Not Activated"),i())}function he(t,o){if(t&1){let s=y();r(0,"div",10)(1,"button",11),g("click",function(){x(s);let e=p();return b(e.setupTotp())}),a(2,"Activate "),i()()}if(t&2){let s=p();c(),d("disableIfNoRoleExists",C(1,L,s.Role.AUTHENTICATED_USER))}}function ye(t,o){if(t&1){let s=y();r(0,"div",12)(1,"button",13),g("click",function(){x(s);let e=p();return b(e.confirmTotpDeactivation())}),a(2,"Deactivate "),i(),r(3,"button",14),g("click",function(){x(s);let e=p();return b(e.testCode())}),a(4,"Test "),i()()}if(t&2){let s=p();c(),d("disableIfNoRoleExists",C(2,L,s.Role.AUTHENTICATED_USER)),c(2),d("disableIfNoRoleExists",C(4,L,s.Role.AUTHENTICATED_USER))}}var le=(()=>{let o=class o{constructor(){this.destroyRef=m(T),this.dialog=m(w),this.myAccountService=m(A),this.authService=m(X),this.isTotpActive=E(!1),this.Role=R}setupTotp(){this.dialog.open(se,{disableClose:!0}).afterClosed().pipe(f(this.destroyRef)).subscribe(e=>{console.log("Result:",e),this.getCurrentTotpStatus()})}ngOnInit(){this.getCurrentTotpStatus()}getCurrentTotpStatus(){this.myAccountService.getTotpStatus().pipe(f(this.destroyRef)).subscribe({next:n=>{this.isTotpActive.set(n.active)},error:n=>console.log(n)})}testCode(){this.dialog.open(oe,{disableClose:!0}).afterClosed().pipe(f(this.destroyRef)).subscribe(e=>{console.log("Result:",e)})}confirmTotpDeactivation(){this.dialog.open(Y,{disableClose:!0}).afterClosed().pipe(f(this.destroyRef)).subscribe(e=>{e===!0&&this.deactivateTotp()})}deactivateTotp(){this.myAccountService.deactivateTotp().pipe(f(this.destroyRef)).subscribe({next:n=>this.getCurrentTotpStatus(),error:n=>console.log(n)})}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["my-totp-settings"]],inputs:{isTotpActive:[1,"isTotpActive"]},outputs:{isTotpActive:"isTotpActiveChange"},standalone:!0,features:[S],decls:9,vars:3,consts:[[1,"container","d-flex","flex-column","gradient-bg-light-left","mt-2","pt-2","pb-3","border","border-opacity-50","rounded-2","shadow","border-primary"],[1,"col","d-inline-flex"],[1,"gradient-text"],[1,"status-badge","text-nowrap"],[1,"text-success","border","border-success","border-2","rounded-2","p-1","small","ms-1","me-1"],[1,"text-danger","border","border-danger","border-2","rounded-2","p-1","small","ms-1","me-1"],["class","activation col",4,"ngIf"],["class","deactivation col d-inline-flex gap-2",4,"ngIf"],[1,"bi","bi-check-circle-fill"],[1,"bi","bi-exclamation-octagon-fill"],[1,"activation","col"],["type","button",1,"btn","btn-success",3,"click","disableIfNoRoleExists"],[1,"deactivation","col","d-inline-flex","gap-2"],["type","button",1,"btn","btn-outline-danger",3,"click","disableIfNoRoleExists"],["type","button",1,"btn","btn-outline-primary",3,"click","disableIfNoRoleExists"]],template:function(e,l){e&1&&(r(0,"section",0)(1,"div",1)(2,"h4",2),a(3,"Authenticator TOTP"),i(),r(4,"div",3),v(5,ve,3,0,"span",4)(6,_e,3,0,"span",5),i()(),v(7,he,3,3,"div",6)(8,ye,5,6,"div",7),i()),e&2&&(c(5),M(l.isTotpActive()?5:6),c(2),d("ngIf",!l.isTotpActive()),c(),d("ngIf",l.isTotpActive()))},dependencies:[D,I]});let t=o;return t})();var ce=t=>[t];function Se(t,o){t&1&&(r(0,"span",5),u(1,"i",10),a(2," Activated"),i())}function Ce(t,o){t&1&&(r(0,"span",6),u(1,"i",11),a(2," Not Activated"),i())}function Ee(t,o){t&1&&(r(0,"div",12)(1,"p"),a(2,"Multi-Factor authentication activation possible only after any one the following security information successfully activated or verified,"),i(),r(3,"ul")(4,"li"),a(5,"Email Address"),i(),r(6,"li"),a(7,"TOTP"),i()()())}function Te(t,o){t&1&&(r(0,"p",16),a(1," Unable to activate MFA. Please check prerequisite conditions before activating MFA. "),i())}function Ae(t,o){if(t&1){let s=y();r(0,"div",13)(1,"button",14),g("click",function(){x(s);let e=p(2);return b(e.enableMfa())}),a(2,"Activate "),i(),v(3,Te,2,0,"p",15),i()}if(t&2){let s=p(2);c(),d("disableIfNoRoleExists",C(2,ce,s.Role.AUTHENTICATED_USER)),c(2),d("ngIf",s.isErrorOccurred())}}function Me(t,o){t&1&&(r(0,"p",16),a(1," Unable to deactivate MFA. Please try again. "),i())}function De(t,o){if(t&1){let s=y();r(0,"div",17)(1,"button",18),g("click",function(){x(s);let e=p(2);return b(e.confirmMfaDeactivation())}),a(2,"Deactivate "),i(),v(3,Me,2,0,"p",15),i()}if(t&2){let s=p(2);c(),d("disableIfNoRoleExists",C(2,ce,s.Role.AUTHENTICATED_USER)),c(2),d("ngIf",s.isErrorOccurred())}}function Re(t,o){if(t&1&&(r(0,"section",1)(1,"div",2)(2,"h4",3),a(3,"Multi-Factor Authentication"),i(),r(4,"div",4),v(5,Se,3,0,"span",5)(6,Ce,3,0,"span",6),i()(),v(7,Ee,8,0,"div",7)(8,Ae,4,4,"div",8)(9,De,4,4,"div",9),i()),t&2){let s,n,e,l,_=p();c(5),M((s=_.userData())!=null&&s.mfaEnabled?5:6),c(2),d("ngIf",!((n=_.userData())!=null&&n.mfaEnabled)),c(),d("ngIf",!((e=_.userData())!=null&&e.mfaEnabled)),c(),d("ngIf",(l=_.userData())==null?null:l.mfaEnabled)}}var de=(()=>{let o=class o{constructor(){this.Role=R,this.destroyRef=m(T),this.dialog=m(w),this.myAccountService=m(A),this.userData=E(),this.isErrorOccurred=E(!0)}ngOnInit(){this.fetchCurrentUserData()}fetchCurrentUserData(){this.myAccountService.getProfileData().pipe(f(this.destroyRef)).subscribe({next:n=>{this.userData.set(n),this.isErrorOccurred.set(!1)},error:n=>console.log(n)})}enableMfa(){this.changeMfa(!0)}confirmMfaDeactivation(){this.dialog.open(Y,{disableClose:!0}).afterClosed().pipe(f(this.destroyRef)).subscribe(e=>{e===!0&&this.changeMfa(!1)})}changeMfa(n){this.myAccountService.changeMfaStatus(n).pipe(f(this.destroyRef)).subscribe({next:e=>this.fetchCurrentUserData(),error:e=>{console.log(e),this.isErrorOccurred.set(!0)}})}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["app-mfa-settings"]],inputs:{userData:[1,"userData"],isErrorOccurred:[1,"isErrorOccurred"]},outputs:{userData:"userDataChange",isErrorOccurred:"isErrorOccurredChange"},standalone:!0,features:[S],decls:1,vars:1,consts:[["class","container d-flex flex-column gradient-bg-light-left mt-2 pt-2 pb-3 border border-opacity-50 rounded-2 shadow border-primary",4,"ngIf"],[1,"container","d-flex","flex-column","gradient-bg-light-left","mt-2","pt-2","pb-3","border","border-opacity-50","rounded-2","shadow","border-primary"],[1,"col","d-inline-flex"],[1,"gradient-text"],[1,"status-badge","text-nowrap"],[1,"text-success","border","border-success","border-2","rounded-2","p-1","small","ms-1","me-1"],[1,"text-danger","border","border-danger","border-2","rounded-2","p-1","small","ms-1","me-1"],["class","text-primary small fw-bold",4,"ngIf"],["class","activation col",4,"ngIf"],["class","deactivation col d-inline-flex gap-2",4,"ngIf"],[1,"bi","bi-check-circle-fill"],[1,"bi","bi-exclamation-octagon-fill"],[1,"text-primary","small","fw-bold"],[1,"activation","col"],["type","button",1,"btn","btn-success",3,"click","disableIfNoRoleExists"],["class","text-danger small fw-bold",4,"ngIf"],[1,"text-danger","small","fw-bold"],[1,"deactivation","col","d-inline-flex","gap-2"],["type","button",1,"btn","btn-outline-danger",3,"click","disableIfNoRoleExists"]],template:function(e,l){e&1&&v(0,Re,10,4,"section",0),e&2&&d("ngIf",l.userData())},dependencies:[D,I]});let t=o;return t})();var kt=(()=>{let o=class o{constructor(){this.MY_SECURITY_SETTINGS_PAGE_INFO=Z}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=h({type:o,selectors:[["app-my-account-settings-page"]],standalone:!0,features:[S],decls:4,vars:1,consts:[[3,"pageInfo"]],template:function(e,l){e&1&&u(0,"app-page-header",0)(1,"my-email-address-settings")(2,"my-totp-settings")(3,"app-mfa-settings"),e&2&&d("pageInfo",l.MY_SECURITY_SETTINGS_PAGE_INFO)},dependencies:[$,ae,le,de]});let t=o;return t})();export{kt as MyAccountSettingsPageComponent};
