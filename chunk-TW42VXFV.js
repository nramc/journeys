import{a as z}from"./chunk-OEK3JCZ4.js";import{a as B}from"./chunk-33A7BMWG.js";import{a as O}from"./chunk-QS7RPCLH.js";import{j as $}from"./chunk-SNVCUL6N.js";import{c as G}from"./chunk-AOMZEFOI.js";import{a as q}from"./chunk-BZBETYD3.js";import{b as N}from"./chunk-R6MPEOK3.js";import"./chunk-A2N4MVAO.js";import{g as M}from"./chunk-EGCIWAOK.js";import{c as D}from"./chunk-HLWHUVVB.js";import{i as E}from"./chunk-T74QBNJG.js";import{$c as A,Ac as y,Da as S,Ea as x,Hb as I,Mb as a,Qa as f,Sb as T,Vb as P,Wb as k,Xb as o,Yb as s,Zb as c,bc as F,gc as v,ic as p,ka as b,kb as w,ob as n,pa as C,qa as u,sa as g,tc as l,uc as j,vc as h}from"./chunk-VRY62XD3.js";var L=(()=>{class r{constructor(t,e){this.httpClient=t,this.authService=e}getStatistics(){let t=this.authService.getCurrentUserContext();return this.httpClient.get(q.journeyApi+"/journeys/statistics",{headers:{Authorization:`Bearer ${t.accessToken}`}})}static{this.\u0275fac=function(e){return new(e||r)(C(D),C(N))}}static{this.\u0275prov=b({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var V=(r,d)=>d.name;function R(r,d){if(r&1){let t=F();o(0,"a",5),v("click",function(){let i=S(t).$implicit,m=p();return x(m.gotoGallery(m.type(),i.name))}),o(1,"div",6)(2,"div",7)(3,"h5",8),l(4),s(),o(5,"button",9),v("click",function(i){let m=S(t).$implicit,_=p();return x(_.gotoTimeline(_.type(),m.name,i))}),c(6,"i",10),s()(),o(7,"div",11)(8,"div",12)(9,"h2",13),l(10),s()(),o(11,"div",14)(12,"span"),l(13),s()()(),c(14,"mat-progress-bar",15),s()()}if(r&2){let t=d.$implicit,e=d.$index,i=p();a("ngClass","card-"+e),n(4),j(t.name),n(6),h(" ",t.count," "),n(3),h("",i.getPercentage(t.count,i.totalCount()),"%"),n(),a("value",i.getPercentage(t.count,i.totalCount()))}}var U=(()=>{class r{constructor(){this.router=u(M),this.data=f.required(),this.header=f.required(),this.type=f.required(),this.totalCount=A(()=>this.data().map(t=>t.count).reduce((t,e)=>t+e))}comparatorFn(t,e){return t.name.toLowerCase().localeCompare(e.name.toLowerCase())}gotoGallery(t,e){this.router.navigate(["/gallery"],{state:this.getSearchCriteria(t,e)}).then(console.log)}gotoTimeline(t,e,i){return i.stopPropagation(),this.router.navigate(["/timeline"],{queryParams:{[t]:e}}).then(console.log),!1}getSearchCriteria(t,e){let i=new z;switch(t){case"category":i.category=e;break;case"city":i.city=e;break;case"country":i.country=e;break;case"year":i.year=e;break}return i}getPercentage(t,e){return Math.round(t/e*100)}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-statistics-panel"]],inputs:{data:[1,"data"],header:[1,"header"],type:[1,"type"]},standalone:!0,features:[y],decls:7,vars:3,consts:[[1,"mt-3","p-2","rounded-2","d-flex","flex-column"],[1,"gradient-bg","rounded-2","border","border-primary"],["data-bs-toggle","collapse","aria-expanded","true",1,"text-decoration-none","text-light","ps-2","w-100","fs-5","d-flex","toggle-link","d-inline-flex","align-items-center","justify-content-between",3,"href"],[1,"card-group","gap-2","show","ps-2",3,"id"],[1,"text-decoration-none","card","border","border-primary","border-1","rounded-2",3,"ngClass"],[1,"text-decoration-none","card","border","border-primary","border-1","rounded-2",3,"click","ngClass"],[1,"card-statistics","p-4"],[1,"mb-4","d-inline-flex","justify-content-around","w-100"],[1,"card-title","gradient-text","mb-0"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"bi","bi-clock-history"],[1,"row","align-items-center","mb-2","d-flex"],[1,"col-8"],[1,"d-flex","align-items-center","mb-0","gradient-text"],[1,"col-4","text-right","gradient-text"],["mode","determinate",3,"value"]],template:function(e,i){e&1&&(o(0,"section",0)(1,"legend",1)(2,"a",2),l(3),s()(),o(4,"div",3),P(5,R,15,5,"a",4,V),s()()),e&2&&(n(2),a("href","#"+i.header(),w),n(),h(" ",i.header()," "),n(),a("id",i.header()),n(),k(i.data().sort(i.comparatorFn)))},dependencies:[B,E],styles:[".card[_ngcontent-%COMP%]{cursor:pointer;max-width:20rem!important;width:20rem!important;min-width:20rem!important}"],changeDetection:0})}}return r})();function Y(r,d){if(r&1&&c(0,"app-statistics-panel",1)(1,"app-statistics-panel",2)(2,"app-statistics-panel",3)(3,"app-statistics-panel",4),r&2){let t=p();a("data",t.statistics().years),n(),a("data",t.statistics().countries),n(),a("data",t.statistics().cities),n(),a("data",t.statistics().categories)}}var ft=(()=>{class r{constructor(){this.STATISTICS_PAGE_INFO=$,this.statisticsService=u(L),this.statistics=G(this.statisticsService.getStatistics())}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-statistics"]],standalone:!0,features:[y],decls:2,vars:2,consts:[[3,"pageInfo"],["type","year","header","Years",3,"data"],["type","country","header","Countries",3,"data"],["type","city","header","Cities",3,"data"],["type","category","header","Categories",3,"data"]],template:function(e,i){e&1&&(c(0,"app-page-header",0),I(1,Y,4,4)),e&2&&(a("pageInfo",i.STATISTICS_PAGE_INFO),n(),T(i.statistics()?1:-1))},dependencies:[O,U],changeDetection:0})}}return r})();export{ft as StatisticsComponent};
