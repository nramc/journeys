"use strict";(self.webpackChunkjourney=self.webpackChunkjourney||[]).push([[142],{4016:(C,d,s)=>{s.d(d,{y:()=>i});var a=s(4438);let i=(()=>{class c{static#e=this.\u0275fac=function(p){return new(p||c)};static#t=this.\u0275cmp=a.VBU({type:c,selectors:[["app-page-header"]],inputs:{pageInfo:"pageInfo"},standalone:!0,features:[a.aNF],decls:4,vars:2,consts:[[1,"page-title-container","row","m-3","pb-3","border-bottom","border-primary-subtle","border-3"],[1,"col"],[1,"gradient-text","page-title",3,"innerHTML"],[1,"text-primary","opacity-75","page-description",3,"innerHTML"]],template:function(p,y){1&p&&(a.j41(0,"div",0)(1,"div",1),a.nrm(2,"h3",2)(3,"h6",3),a.k0s()()),2&p&&(a.R7$(2),a.Y8G("innerHTML",null==y.pageInfo?null:y.pageInfo.title,a.npT),a.R7$(),a.Y8G("innerHTML",null==y.pageInfo?null:y.pageInfo.description,a.npT))},encapsulation:2})}return c})()},7142:(C,d,s)=>{s.r(d),s.d(d,{DashboardComponent:()=>h});var a=s(1030),i=s(8722),c=s(4016),g=s(177),e=s(4438),p=s(7404);const y=(u,_)=>_[0];function t(u,_){if(1&u&&(e.j41(0,"div",8)(1,"span",9),e.EFF(2),e.k0s(),e.j41(3,"div",10),e.EFF(4),e.k0s()()),2&u){const o=_.$implicit;e.R7$(2),e.JRh(o[1]),e.R7$(2),e.JRh(o[0])}}function r(u,_){if(1&u&&(e.j41(0,"div",7),e.Z7z(1,t,5,2,"div",8,y),e.k0s()),2&u){const o=e.XpG();e.R7$(),e.Dyx(o.stats.entries())}}let h=(()=>{class u{constructor(o){this.journeyService=o,this.DASHBOARD_PAGE_INFO=a.aY,this.stats=new Map}ngOnInit(){this.journeyService.getAllJourneysAsGeoJson().subscribe(o=>this.onFetchSuccessCallback(o))}onFetchSuccessCallback(o){this.featureCollection=o,this.collectStats(o)}collectStats(o){this.stats.set("Journeys",o.features.length),this.stats.set("Places",this.uniqueJourneysByProperty(o,"location")),this.stats.set("Country",this.uniqueJourneysByProperty(o,"country")),this.stats.set("City",this.uniqueJourneysByProperty(o,"city"))}uniqueJourneysByProperty(o,l){return o.features.filter(n=>n.properties?.[l]).filter((n,v,m)=>m.findIndex(f=>JSON.stringify(f.properties?.[l])===JSON.stringify(n.properties?.[l]))===v).length}static#e=this.\u0275fac=function(l){return new(l||u)(e.rXU(p.K))};static#t=this.\u0275cmp=e.VBU({type:u,selectors:[["app-dashboard"]],standalone:!0,features:[e.aNF],decls:7,vars:3,consts:[[3,"pageInfo"],[1,"container"],[1,"row","mb-2"],["class","col-12 d-flex gap-2 flex-wrap justify-content-center align-content-center",4,"ngIf"],[1,"row"],[1,"col",2,"position","relative","height","70vh"],["enablePopup","true",3,"geoJsonData"],[1,"col-12","d-flex","gap-2","flex-wrap","justify-content-center","align-content-center"],[1,"text-center","border","border-primary","border-2","rounded","rounded-2","p-2",2,"min-width","75px"],[1,"fs-3","gradient-text","text-primary","fw-bold"],[1,"small","gradient-text"]],template:function(l,n){1&l&&(e.nrm(0,"app-page-header",0),e.j41(1,"section",1)(2,"div",2),e.DNE(3,r,3,0,"div",3),e.k0s(),e.j41(4,"div",4)(5,"div",5),e.nrm(6,"app-world-map",6),e.k0s()()()),2&l&&(e.Y8G("pageInfo",n.DASHBOARD_PAGE_INFO),e.R7$(3),e.Y8G("ngIf",n.stats),e.R7$(3),e.Y8G("geoJsonData",n.featureCollection))},dependencies:[c.y,i.s,g.bT]})}return u})()},7404:(C,d,s)=>{s.d(d,{K:()=>e});var a=s(1626),i=s(2525),c=s(4438),g=s(4486);let e=(()=>{class p{constructor(t,r){this.httpClient=t,this.authService=r}createJourney(t){let r=this.authService.getCurrentUserContext();return this.httpClient.post(i.c.journeyApi+"/journey",t,{headers:{Authorization:`Bearer ${r.accessToken}`}})}findJourneyByQuery(t,r,h,u,_,o,l=[]){let n=new a.Nl;return n=n.set("q",t),n=n.set("sort",r),n=n.set("order",h.toUpperCase()),n=n.set("pageIndex",u),n=n.set("pageSize",_),n=n.set("publishedOnly",o),n=n.set("tags",l.join(",")),console.log(n),this.getAllJourneys(n)}getAllJourneys(t){let r=this.authService.getCurrentUserContext();return this.httpClient.get(i.c.journeyApi+"/journeys",{params:t,headers:{Authorization:`Bearer ${r.accessToken}`}})}getAllJourneysAsGeoJson(){let t=this.authService.getCurrentUserContext();return this.httpClient.get(i.c.journeyApi+"/journeys/published",{headers:{Accept:"application/geo+json",Authorization:`Bearer ${t.accessToken}`}})}getJourneyById(t){let r=this.authService.getCurrentUserContext();return this.httpClient.get(i.c.journeyApi+"/journey/"+t,{headers:{Authorization:`Bearer ${r.accessToken}`}})}saveJourneyBasicDetails(t){let r=this.authService.getCurrentUserContext();return this.httpClient.put(i.c.journeyApi+"/journey/"+t.id,t,{headers:{"Content-Type":"application/vnd.journey.api.basic.v1+json",Authorization:`Bearer ${r.accessToken}`}})}saveJourneyGeoDetails(t,r){let h=this.authService.getCurrentUserContext();return this.httpClient.put(i.c.journeyApi+"/journey/"+t.id,r,{headers:{"Content-Type":"application/vnd.journey.api.geo.v1+json",Authorization:`Bearer ${h.accessToken}`}})}saveJourneyImagesDetails(t,r){let h=this.authService.getCurrentUserContext();return this.httpClient.put(i.c.journeyApi+"/journey/"+t.id,r,{headers:{"Content-Type":"application/vnd.journey.api.images.v1+json",Authorization:`Bearer ${h.accessToken}`}})}saveJourneyVideosDetails(t,r){let h=this.authService.getCurrentUserContext();return this.httpClient.put(i.c.journeyApi+"/journey/"+t.id,r,{headers:{"Content-Type":"application/vnd.journey.api.videos.v1+json",Authorization:`Bearer ${h.accessToken}`}})}publishJourney(t){let r=this.authService.getCurrentUserContext();return this.httpClient.put(i.c.journeyApi+"/journey/"+t.id,t,{headers:{"Content-Type":"application/vnd.journey.api.publish.v1+json",Authorization:`Bearer ${r.accessToken}`}})}static#e=this.\u0275fac=function(r){return new(r||p)(c.KVO(a.Qq),c.KVO(g.u))};static#t=this.\u0275prov=c.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}return p})()}}]);