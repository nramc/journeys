import{a as Me}from"./chunk-OEK3JCZ4.js";import{a as x}from"./chunk-HRMIQOZA.js";import"./chunk-734OPSWI.js";import{a as ue,b as de,c as ge,d as he,e as ye}from"./chunk-TIDIKASE.js";import{b as _e,c as Ce,d as fe,f as we}from"./chunk-SU7AERC3.js";import{a as ce}from"./chunk-3W36CHB7.js";import{a as ee,b as te,c as ie,d as re}from"./chunk-QIUNYK6U.js";import"./chunk-MOIY7QW2.js";import"./chunk-4ZW7E4TV.js";import"./chunk-5M2JJTQ6.js";import"./chunk-2RSQIKR3.js";import"./chunk-XTTRI24Y.js";import"./chunk-7SKX3N7G.js";import{b as ae}from"./chunk-3QUYC5QE.js";import{i as oe}from"./chunk-F6OSNDWH.js";import"./chunk-GGG2HDDJ.js";import{h as Y}from"./chunk-BS35BKX7.js";import{b as pe,c as me}from"./chunk-46C5OQ3F.js";import{f as le,g as se}from"./chunk-X7YUYQ54.js";import"./chunk-FSERETJE.js";import"./chunk-F4DSFHW7.js";import"./chunk-CHGDWI4X.js";import"./chunk-66AFA25Q.js";import{b as U,g as $,j as X,u as Z}from"./chunk-WYGIYYQO.js";import"./chunk-5HCI3JVT.js";import{b as K}from"./chunk-RL25V5BE.js";import"./chunk-OMHRRS7A.js";import"./chunk-OG5DQ5VQ.js";import{a as q}from"./chunk-RQKRTOUM.js";import{h as ne}from"./chunk-OLDPWYQ6.js";import"./chunk-SUU2CJAS.js";import{c as H}from"./chunk-CLWH3GUL.js";import{m as J,n as Q}from"./chunk-LVLQ6W55.js";import{$ as A,$c as z,Bc as d,Dc as y,Ea as I,Fc as M,Gc as v,Hc as b,I as B,L as P,Lc as N,Pc as S,Qc as E,Sb as T,Tb as _,Ub as C,Vb as h,Wb as i,Xb as l,Y as j,Yb as F,_ as R,ec as f,jb as a,jc as u,l as G,ma as D,mc as w,sa as p,ta as m,u as k,uc as O,vc as W,wc as V,yb as L}from"./chunk-JOM6ROGP.js";var ve=()=>[1,5,10,20,25],be=(o,g)=>g.id;function Se(o,g){if(o&1){let t=f();i(0,"mat-chip-row",25),u("removed",function(){let e=p(t).$implicit,r=w();return m(r.removeTag(e))}),d(1),i(2,"button",26),u("click",function(){let e=p(t).$implicit,r=w();return m(r.removeTag(e))}),i(3,"mat-icon"),d(4,"cancel"),l()()()}if(o&2){let t=g.$implicit;h("highlighted",!0)("editable",!1)("removable",!0),a(),y(" ",t," ")}}function Ee(o,g){if(o&1){let t=f();i(0,"button",27),u("click",function(){let e=p(t).$implicit,r=w();return m(r.sortingFieldChangedEvent.next(e))}),d(1),S(2,"titlecase"),l()}if(o&2){let t=g.$implicit;a(),y(" ",E(2,1,t.label)," ")}}function Ie(o,g){if(o&1){let t=f();i(0,"button",27),u("click",function(){let e=p(t).$implicit,r=w();return m(r.sortingDirectionChangedEvent.next(e))}),d(1),S(2,"uppercase"),l()}if(o&2){let t=g.$implicit;a(),y(" ",E(2,1,t)," ")}}function Te(o,g){if(o&1&&F(0,"app-journey-card-view",24),o&2){let t=g.$implicit;h("journey",t)}}var at=(()=>{class o{constructor(){this.journeyService=D(oe),this.sortableFields=[{label:"Journey Date",key:"journeyDate"},{label:"Journey Name",key:"name"},{label:"Geo Title",key:"geoDetails.title"},{label:"City",key:"geoDetails.city"},{label:"Country",key:"geoDetails.country"},{label:"Category",key:"geoDetails.category"},{label:"Geo Location",key:"geoDetails.location"}],this.sortingFieldChangedEvent=new G({label:"Journey Date",key:"journeyDate"}),this.sortableDirections=["asc","desc"],this.sortingDirectionChangedEvent=new G("desc"),this.defaultPageSize=10,this.separatorKeysCodes=[13,188,32],this.searchCriteria=I(new Me),this.paginator=z.required(x),this.tags=I([]),this.tagsObservable=K(this.tags),this.searchResult=I({totalElements:0,data:[]}),this.GALLERY_PAGE_INFO=Y;let t=D(H);t.getCurrentNavigation()?.extras.state&&this.searchCriteria.set(t.getCurrentNavigation()?.extras.state)}ngAfterViewInit(){this.search()}search(){B(this.paginator().page,this.sortingFieldChangedEvent,this.sortingDirectionChangedEvent,this.tagsObservable).pipe(R(),A(()=>this.journeyService.findJourneyByQuery(this.searchCriteria(),this.sortingFieldChangedEvent.getValue().key,this.sortingDirectionChangedEvent.getValue(),this.paginator().pageIndex,this.paginator().pageSize,!0,this.tags()).pipe(j(1),P(()=>k(null))))).subscribe(t=>this.onSuccess(t))}onSuccess(t){this.searchResult.set({totalElements:t?.totalElements??0,data:t?.content??[]})}ngOnInit(){this.journeyService.findJourneyByQuery(this.searchCriteria(),"journeyDate","desc",0,this.defaultPageSize,!0).subscribe(t=>this.onSuccess(t))}addTag(t){let s=(t.value||"").trim();s&&this.tags.update(e=>[...e,s]),t.chipInput.clear()}removeTag(t){this.tags.update(s=>s.filter(e=>e!==t))}static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275cmp=L({type:o,selectors:[["app-gallery"]],viewQuery:function(s,e){s&1&&O(e.paginator,x,5),s&2&&W()},decls:50,vars:21,consts:[["chipGrid",""],["sortingFieldMenu","matMenu"],["sortingDirectionMenu","matMenu"],[3,"pageInfo"],[1,"container","py-2"],["id","searchFields"],[1,"text-sm","font-normal"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","mt-3"],["appearance","outline",1,"w-full"],["matInput","","type","text","id","categoryInput","placeholder","Category",3,"ngModelChange","change","ngModel"],["matInput","","type","text","id","cityInput","placeholder","City",3,"ngModelChange","change","ngModel"],["matInput","","type","text","id","countryInput","placeholder","Country",3,"ngModelChange","change","ngModel"],["matInput","","type","text","id","yearInput","placeholder","Year",3,"ngModelChange","change","ngModel"],[1,"container","p-0","m-0"],["aria-label","Tags",1,"w-full"],["matInput","","id","tagsInput","placeholder","Filter by Tags",3,"matChipInputTokenEnd","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur"],[1,"flex","flex-wrap","gap-1","m-0"],["color","primary",3,"highlighted","editable","removable"],[1,"m-0","p-0","flex","justify-center","max-sm:flex-col","text-center","content-center","items-center"],["aria-label","Select page","color","primary",1,"paginator",3,"length","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"inline-flex"],["mat-menu-item",""],["mat-button","",1,"text-primary","border","border-primary","bg-white","px-2","py-1","rounded-md","shadow-sm","hover:bg-gray-100",3,"matMenuTriggerFor"],[1,"container","flex","gap-2","items-center","justify-center","flex-wrap"],[1,"max-sm:w-full",3,"journey"],["color","primary",3,"removed","highlighted","editable","removable"],["matChipRemove","",3,"click"],["mat-menu-item","",3,"click"]],template:function(s,e){if(s&1){let r=f();i(0,"header"),F(1,"app-page-header",3),l(),i(2,"main")(3,"section",4)(4,"mat-expansion-panel",5)(5,"mat-expansion-panel-header")(6,"mat-panel-title",6)(7,"span"),d(8,"Filter"),l()()(),i(9,"div",7)(10,"mat-form-field",8)(11,"input",9),b("ngModelChange",function(n){return p(r),v(e.searchCriteria().category,n)||(e.searchCriteria().category=n),m(n)}),u("change",function(){return p(r),m(e.search())}),l()(),i(12,"mat-form-field",8)(13,"input",10),b("ngModelChange",function(n){return p(r),v(e.searchCriteria().city,n)||(e.searchCriteria().city=n),m(n)}),u("change",function(){return p(r),m(e.search())}),l()(),i(14,"mat-form-field",8)(15,"input",11),b("ngModelChange",function(n){return p(r),v(e.searchCriteria().country,n)||(e.searchCriteria().country=n),m(n)}),u("change",function(){return p(r),m(e.search())}),l()(),i(16,"mat-form-field",8)(17,"input",12),b("ngModelChange",function(n){return p(r),v(e.searchCriteria().year,n)||(e.searchCriteria().year=n),m(n)}),u("change",function(){return p(r),m(e.search())}),l()()(),i(18,"div",13)(19,"mat-chip-grid",14,0)(21,"mat-form-field",8)(22,"input",15),u("matChipInputTokenEnd",function(n){return p(r),m(e.addTag(n))}),l()(),i(23,"div",16),_(24,Se,5,4,"mat-chip-row",17,T),l()()()()(),i(26,"section",18),F(27,"mat-paginator",19),i(28,"div",20)(29,"mat-menu",null,1),_(31,Ee,3,3,"button",21,T),l(),i(33,"button",22),d(34),S(35,"titlecase"),i(36,"mat-icon"),d(37,"arrow_drop_down"),l()(),i(38,"mat-menu",null,2),_(40,Ie,3,3,"button",21,T),l(),i(42,"button",22),d(43),S(44,"uppercase"),i(45,"mat-icon"),d(46,"arrow_drop_down"),l()()()(),i(47,"section",23),_(48,Te,1,1,"app-journey-card-view",24,be),l()()}if(s&2){let r=V(20),c=V(30),n=V(39);a(),h("pageInfo",e.GALLERY_PAGE_INFO),a(10),M("ngModel",e.searchCriteria().category),a(2),M("ngModel",e.searchCriteria().city),a(2),M("ngModel",e.searchCriteria().country),a(2),M("ngModel",e.searchCriteria().year),a(5),h("matChipInputFor",r)("matChipInputSeparatorKeyCodes",e.separatorKeysCodes)("matChipInputAddOnBlur",!0),a(2),C(e.tags()),a(3),h("length",e.searchResult().totalElements)("pageSize",e.defaultPageSize)("pageSizeOptions",N(20,ve))("showFirstLastButtons",!0),a(4),C(e.sortableFields),a(2),h("matMenuTriggerFor",c),a(),y(" ",E(35,16,e.sortingFieldChangedEvent.getValue().label)," "),a(6),C(e.sortableDirections),a(2),h("matMenuTriggerFor",n),a(),y(" ",E(44,18,e.sortingDirectionChangedEvent.getValue())," "),a(5),C(e.searchResult().data)}},dependencies:[x,ye,ge,he,ue,de,q,Z,U,$,X,ae,se,le,me,pe,we,_e,Ce,fe,ne,re,te,ee,ie,ce,J,Q],styles:[".paginator[_ngcontent-%COMP%]{text-align:center;align-items:center;justify-content:center!important;display:flex;font-weight:500}"],changeDetection:0})}}return o})();export{at as GalleryComponent};
