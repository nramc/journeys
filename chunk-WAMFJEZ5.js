import{a as B}from"./chunk-B5NGEDAU.js";import{c as O,g as j,h as R,i as W,j as D,k as Y,s as z,v as H,x as J}from"./chunk-5L65BU43.js";import{b as G}from"./chunk-SNVCUL6N.js";import{a as T,b as V}from"./chunk-P7PPGZS3.js";import{e as U,g as q,h as A}from"./chunk-XEJULNW6.js";import"./chunk-7FBRJZ3K.js";import"./chunk-5XB5PZR3.js";import{r as N}from"./chunk-4NTYDSMY.js";import{Cb as E,Ha as g,Ia as f,Lb as b,Nb as d,Sb as I,Wb as t,Xb as n,Yb as h,ac as P,fc as S,hc as k,lb as M,pb as m,qb as p,qc as v,rc as a,uc as w,vc as y,wc as x,xa as L,yc as F}from"./chunk-7FH2CJX7.js";function K(i,s){if(i&1&&h(0,"app-feedback-message",6),i&2){let _=k();d("message",_.feedbackMessage())}}function Q(i,s){i&1&&(t(0,"div",7),h(1,"i",29),a(2," Identity Yourself to access secured resource..! "),n())}function X(i,s){i&1&&(t(0,"div",8),h(1,"i",29),a(2," You have been successfully logged out! "),n())}function Z(i,s){i&1&&(t(0,"div",9),h(1,"i",29),a(2," Identity Yourself to access more exciting features..! "),n())}function $(i,s){i&1&&(t(0,"div"),a(1,"Username is required."),n())}function ee(i,s){i&1&&(t(0,"div"),a(1,"Username must be at most 50 characters long."),n())}function te(i,s){i&1&&(t(0,"div"),a(1,"Password is required."),n())}function ie(i,s){i&1&&(t(0,"div"),a(1,"Password must be at most 50 characters long."),n())}var pe=(()=>{let s=class s{constructor(r,o,e,u){this.authService=r,this.loginService=o,this.router=e,this.activatedRoute=u,this.feedbackMessage=E({}),this.form=new C,this.messageBanner="",this.SIGNUP_PAGE_INFO=G,this.forgotPasswordAssistanceUrl="https://github.com/nramc/journeys/issues/new?assignees=&labels=bug&projects=&template=bug-report-form.yml&title=%5BBug%5D%3A+"}ngOnInit(){this.messageBanner=this.activatedRoute.snapshot.queryParams.q}login(r){if(r.valid){let o={username:this.form.userName,password:this.form.password};this.loginService.login(o).subscribe({next:e=>this.onLoginSuccess(o,e),error:e=>{r.resetForm(),this.onLoginFailed(e)}})}}onLoginSuccess(r,o){if(o.additionalFactorRequired){let e={credential:r,options:o.securityAttributes};this.router.navigate(["mfa"],{queryParams:this.activatedRoute.snapshot.queryParams,state:e}).then(console.log)}else{let e=this.authService.getUserContextForSuccessfulLogin(o);this.onLogOnSuccess(e)}}onLoginFailed(r){console.error(r),this.feedbackMessage.set({error:"Login failed. "+r.message})}onLogOnSuccess(r){this.feedbackMessage.set({success:"Login successful for "+r.name});let o=this.activatedRoute.snapshot.queryParams.redirectUrl??"/home";this.router.navigateByUrl(o).then(console.log)}loginAsGuest(){this.loginService.loginAsGuest().subscribe({next:r=>{let o=this.authService.getUserContextForSuccessfulLogin(r);this.onLogOnSuccess(o)},error:r=>this.onLoginFailed(r)})}};s.\u0275fac=function(o){return new(o||s)(p(V),p(T),p(q),p(U))},s.\u0275cmp=L({type:s,selectors:[["app-login"]],standalone:!0,features:[F],decls:43,vars:12,consts:[["loginForm","ngForm"],["username","ngModel"],["password","ngModel"],[1,"container","h-100","mt-3","mt-md-0"],[1,"row","d-flex","justify-content-center","align-items-center","h-100","m-auto"],[1,"col-12","col-md-6","mt-sm-0"],[3,"message"],["role","alert",1,"alert","alert-warning"],["role","alert",1,"alert","alert-success"],["role","alert",1,"alert","alert-primary"],[1,"card","login-card","text-white","border","border-2","border-primary","border-opacity-50",2,"border-radius","1rem"],[1,"card-body","p-5","text-center"],[3,"ngSubmit"],[1,"fw-bold","mb-2"],[1,"text-white-50","mb-5"],[1,"form-outline","form-white","mb-2"],["type","email","id","username","name","username","required","","placeholder","Username","autofocus","","autocomplete","username","maxlength","50",1,"form-control","form-control-lg",3,"ngModelChange","ngModel"],["for","username",1,"form-label","small"],["tabindex","-1",1,"text-light","ms-2",3,"routerLink"],[1,"form-text","text-danger",3,"hidden"],[4,"ngIf"],[1,"form-outline","form-white","mb-4"],["type","password","id","password","name","password","required","","maxlength","50","placeholder","Password","autocomplete","current-password",1,"form-control","form-control-lg",3,"ngModelChange","ngModel"],["for","password",1,"form-label","small"],["target","_blank","tabindex","-1",1,"text-light","ms-2",3,"href"],[1,"d-flex","flex-column","gap-1"],["type","submit",1,"btn","btn-outline-dark","btn-lg",3,"disabled"],[1,"text-light"],["type","button",1,"btn","btn-success","btn-lg",3,"click"],[1,"bi","bi-info-circle","pe-none","me-2"]],template:function(o,e){if(o&1){let u=P();t(0,"div",3)(1,"div",4)(2,"div",5)(3,"div"),b(4,K,1,1,"app-feedback-message",6)(5,Q,3,0,"div",7)(6,X,3,0,"div",8)(7,Z,3,0,"div",9),n(),t(8,"div",10)(9,"div",11)(10,"form",12,0),S("ngSubmit",function(){g(u);let l=v(11);return f(e.login(l))}),t(12,"h2",13),a(13,"Login"),n(),t(14,"p",14),a(15,"Please Identify Yourself!"),n(),t(16,"div",15)(17,"input",16,1),x("ngModelChange",function(l){return g(u),y(e.form.userName,l)||(e.form.userName=l),f(l)}),n(),t(19,"label",17),a(20,"Don't have an account? "),t(21,"a",18),a(22,"Sign Up"),n()(),t(23,"div",19),b(24,$,2,0,"div",20)(25,ee,2,0,"div",20),n()(),t(26,"div",21)(27,"input",22,2),x("ngModelChange",function(l){return g(u),y(e.form.password,l)||(e.form.password=l),f(l)}),n(),t(29,"label",23),a(30,"Forgot Password? "),t(31,"a",24),a(32,"Contact Us"),n()(),t(33,"div",19),b(34,te,2,0,"div",20)(35,ie,2,0,"div",20),n()(),t(36,"div",25)(37,"button",26),a(38,"Submit "),n(),t(39,"small",27),a(40,"or"),n(),t(41,"button",28),S("click",function(){return g(u),f(e.loginAsGuest())}),a(42,"Login as Guest"),n()()()()()()()()}if(o&2){let u=v(11),c=v(18),l=v(28);m(4),I(e.feedbackMessage().success||e.feedbackMessage().error?4:e.messageBanner==="unauthenticated"?5:e.messageBanner==="logoutSuccessful"?6:7),m(13),w("ngModel",e.form.userName),m(4),d("routerLink",e.SIGNUP_PAGE_INFO.path),m(2),d("hidden",c.valid||c.pristine),m(),d("ngIf",c.errors==null?null:c.errors.required),m(),d("ngIf",c.errors==null?null:c.errors.maxlength),m(2),w("ngModel",e.form.password),m(4),d("href",e.forgotPasswordAssistanceUrl,M),m(2),d("hidden",l.valid||l.pristine),m(),d("ngIf",l.errors==null?null:l.errors.required),m(),d("ngIf",l.errors==null?null:l.errors.maxlength),m(2),d("disabled",!u.form.valid||u.submitted)}},dependencies:[J,Y,O,j,R,z,H,D,W,B,N,A],styles:[".login-card[_ngcontent-%COMP%]{background-image:linear-gradient(to right top,#fff,#e2ddfb,#c3bdf7,#a29df2,#7d7fed,#686fea,#4f5fe6,#2c4fe2,#2647df,#203fdc,#1a37d9,#152ed5)}"]});let i=s;return i})(),C=class{constructor(s="",_=""){this.userName=s,this.password=_}};export{pe as LoginComponent};
