"use strict";(self.webpackChunkjourney=self.webpackChunkjourney||[]).push([[142],{4016:(C,h,a)=>{a.d(h,{y:()=>g});var d=a(177),r=a(4438);function l(e,c){if(1&e&&r.nrm(0,"h6",4),2&e){const _=r.XpG();r.Y8G("innerHTML",null==_.pageInfo?null:_.pageInfo.description,r.npT)}}let g=(()=>{class e{static#e=this.\u0275fac=function(t){return new(t||e)};static#t=this.\u0275cmp=r.VBU({type:e,selectors:[["app-page-header"]],inputs:{pageInfo:"pageInfo"},standalone:!0,features:[r.aNF],decls:4,vars:2,consts:[[1,"page-title-container","row","m-3","pb-3","border-bottom","border-primary-subtle","border-3"],[1,"col"],[1,"gradient-text","page-title",3,"innerHTML"],["class","text-primary opacity-75 page-description",3,"innerHTML",4,"ngIf"],[1,"text-primary","opacity-75","page-description",3,"innerHTML"]],template:function(t,n){1&t&&(r.j41(0,"div",0)(1,"div",1),r.nrm(2,"h3",2),r.DNE(3,l,1,1,"h6",3),r.k0s()()),2&t&&(r.R7$(2),r.Y8G("innerHTML",null==n.pageInfo?null:n.pageInfo.title,r.npT),r.R7$(),r.Y8G("ngIf",null==n.pageInfo?null:n.pageInfo.description))},dependencies:[d.bT],encapsulation:2})}return e})()},7142:(C,h,a)=>{a.r(h),a.d(h,{DashboardComponent:()=>p});var d=a(1030),r=a(8722),l=a(4016),g=a(177),e=a(4438),c=a(7404);const _=(i,y)=>y[0];function t(i,y){if(1&i&&(e.j41(0,"div",8)(1,"span",9),e.EFF(2),e.k0s(),e.j41(3,"div",10),e.EFF(4),e.k0s()()),2&i){const s=y.$implicit;e.R7$(2),e.JRh(s[1]),e.R7$(2),e.JRh(s[0])}}function n(i,y){if(1&i&&(e.j41(0,"div",7),e.Z7z(1,t,5,2,"div",8,_),e.k0s()),2&i){const s=e.XpG();e.R7$(),e.Dyx(s.stats.entries())}}let p=(()=>{class i{constructor(s){this.journeyService=s,this.DASHBOARD_PAGE_INFO=d.aY,this.stats=new Map}ngOnInit(){this.journeyService.getAllJourneysAsGeoJson().subscribe(s=>this.onFetchSuccessCallback(s))}onFetchSuccessCallback(s){this.featureCollection=s,this.collectStats(s)}collectStats(s){this.stats.set("Journeys",s.features.length),this.stats.set("Places",this.uniqueJourneysByProperty(s,"location")),this.stats.set("Country",this.uniqueJourneysByProperty(s,"country")),this.stats.set("City",this.uniqueJourneysByProperty(s,"city"))}uniqueJourneysByProperty(s,u){return s.features.filter(o=>o.properties?.[u]).filter((o,v,m)=>m.findIndex(f=>JSON.stringify(f.properties?.[u])===JSON.stringify(o.properties?.[u]))===v).length}static#e=this.\u0275fac=function(u){return new(u||i)(e.rXU(c.K))};static#t=this.\u0275cmp=e.VBU({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[e.aNF],decls:7,vars:3,consts:[[3,"pageInfo"],[1,"container"],[1,"row","mb-2"],["class","col-12 d-flex gap-2 flex-wrap justify-content-center align-content-center",4,"ngIf"],[1,"row"],[1,"col",2,"position","relative","height","70vh"],["enablePopup","true",3,"geoJsonData"],[1,"col-12","d-flex","gap-2","flex-wrap","justify-content-center","align-content-center"],[1,"text-center","border","border-primary","border-2","rounded","rounded-2","p-2",2,"min-width","75px"],[1,"fs-3","gradient-text","text-primary","fw-bold"],[1,"small","gradient-text"]],template:function(u,o){1&u&&(e.nrm(0,"app-page-header",0),e.j41(1,"section",1)(2,"div",2),e.DNE(3,n,3,0,"div",3),e.k0s(),e.j41(4,"div",4)(5,"div",5),e.nrm(6,"app-world-map",6),e.k0s()()()),2&u&&(e.Y8G("pageInfo",o.DASHBOARD_PAGE_INFO),e.R7$(3),e.Y8G("ngIf",o.stats),e.R7$(3),e.Y8G("geoJsonData",o.featureCollection))},dependencies:[l.y,r.s,g.bT]})}return i})()},7404:(C,h,a)=>{a.d(h,{K:()=>e});var d=a(1626),r=a(2525),l=a(4438),g=a(4486);let e=(()=>{class c{constructor(t,n){this.httpClient=t,this.authService=n}createJourney(t){let n=this.authService.getCurrentUserContext();return this.httpClient.post(r.c.journeyApi+"/journey",t,{headers:{Authorization:`Bearer ${n.accessToken}`}})}findJourneyByQuery(t,n,p,i,y,s,u=[]){let o=new d.Nl;return o=o.set("q",t),o=o.set("sort",n),o=o.set("order",p.toUpperCase()),o=o.set("pageIndex",i),o=o.set("pageSize",y),o=o.set("publishedOnly",s),o=o.set("tags",u.join(",")),console.log(o),this.getAllJourneys(o)}getAllJourneys(t){let n=this.authService.getCurrentUserContext();return this.httpClient.get(r.c.journeyApi+"/journeys",{params:t,headers:{Authorization:`Bearer ${n.accessToken}`}})}getAllJourneysAsGeoJson(){let t=this.authService.getCurrentUserContext();return this.httpClient.get(r.c.journeyApi+"/journeys/published",{headers:{Accept:"application/geo+json",Authorization:`Bearer ${t.accessToken}`}})}getJourneyById(t){let n=this.authService.getCurrentUserContext();return this.httpClient.get(r.c.journeyApi+"/journey/"+t,{headers:{Authorization:`Bearer ${n.accessToken}`}})}saveJourneyBasicDetails(t){let n=this.authService.getCurrentUserContext();return this.httpClient.put(r.c.journeyApi+"/journey/"+t.id,t,{headers:{"Content-Type":"application/vnd.journey.api.basic.v1+json",Authorization:`Bearer ${n.accessToken}`}})}saveJourneyGeoDetails(t,n){let p=this.authService.getCurrentUserContext();return this.httpClient.put(r.c.journeyApi+"/journey/"+t.id,n,{headers:{"Content-Type":"application/vnd.journey.api.geo.v1+json",Authorization:`Bearer ${p.accessToken}`}})}saveJourneyImagesDetails(t,n){let p=this.authService.getCurrentUserContext();return this.httpClient.put(r.c.journeyApi+"/journey/"+t.id,n,{headers:{"Content-Type":"application/vnd.journey.api.images.v1+json",Authorization:`Bearer ${p.accessToken}`}})}saveJourneyVideosDetails(t,n){let p=this.authService.getCurrentUserContext();return this.httpClient.put(r.c.journeyApi+"/journey/"+t.id,n,{headers:{"Content-Type":"application/vnd.journey.api.videos.v1+json",Authorization:`Bearer ${p.accessToken}`}})}publishJourney(t){let n=this.authService.getCurrentUserContext();return this.httpClient.put(r.c.journeyApi+"/journey/"+t.id,t,{headers:{"Content-Type":"application/vnd.journey.api.publish.v1+json",Authorization:`Bearer ${n.accessToken}`}})}static#e=this.\u0275fac=function(n){return new(n||c)(l.KVO(d.Qq),l.KVO(g.u))};static#t=this.\u0275prov=l.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()}}]);