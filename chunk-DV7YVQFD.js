import{a as V}from"./chunk-OEK3JCZ4.js";import{a as z}from"./chunk-2MO7FJRM.js";import{a as O}from"./chunk-573XPIHF.js";import{i as M}from"./chunk-W6IR7XEV.js";import{c as N}from"./chunk-ARYB63DG.js";import{a as q}from"./chunk-HWGXPR67.js";import{b as G}from"./chunk-MLFE2CIA.js";import"./chunk-DRY26C2R.js";import{c as $}from"./chunk-A5BAHEOC.js";import"./chunk-GGW32R6S.js";import{c as D}from"./chunk-DUQER7DB.js";import{i as E}from"./chunk-IVYRUNV3.js";import{$b as d,Cc as _,Fa as f,Ga as h,Jb as T,Ob as a,Sa as y,Ub as I,Xb as P,Yb as k,Zb as o,_b as s,ad as A,dc as F,ic as S,ka as b,kc as p,mb as w,pa as x,qa as u,qb as n,ua as g,vc as m,wc as j,xc as C}from"./chunk-4YTPSGIK.js";var H=(()=>{class r{constructor(t,e){this.httpClient=t,this.authService=e}getStatistics(){let t=this.authService.getCurrentUserContext();return this.httpClient.get(q.journeyApi+"/journeys/statistics",{headers:{Authorization:`Bearer ${t.accessToken}`}})}static{this.\u0275fac=function(e){return new(e||r)(x(D),x(G))}}static{this.\u0275prov=b({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var U=(r,l)=>l.name;function R(r,l){if(r&1){let t=F();o(0,"button",5),S("click",function(){let i=f(t).$implicit,c=p();return h(c.gotoGallery(c.type(),i.name))})("keyup.enter",function(){let i=f(t).$implicit,c=p();return h(c.gotoGallery(c.type(),i.name))}),o(1,"div",6)(2,"div",7)(3,"h5",8),m(4),s(),o(5,"button",9),S("click",function(i){let c=f(t).$implicit,v=p();return h(v.gotoTimeline(v.type(),c.name,i))}),d(6,"i",10),s()(),o(7,"div",11)(8,"div",12)(9,"h2",13),m(10),s()(),o(11,"div",14)(12,"span"),m(13),s()()(),d(14,"mat-progress-bar",15),s()()}if(r&2){let t=l.$implicit,e=l.$index,i=p();a("ngClass","card-"+e),n(4),j(t.name),n(6),C(" ",t.count," "),n(3),C("",i.getPercentage(t.count,i.totalCount()),"%"),n(),a("value",i.getPercentage(t.count,i.totalCount()))}}var L=(()=>{class r{constructor(){this.router=u($),this.data=y.required(),this.header=y.required(),this.type=y.required(),this.totalCount=A(()=>this.data().map(t=>t.count).reduce((t,e)=>t+e))}comparatorFn(t,e){return t.name.toLowerCase().localeCompare(e.name.toLowerCase())}gotoGallery(t,e){this.router.navigate(["/gallery"],{state:this.getSearchCriteria(t,e)}).then(console.log)}gotoTimeline(t,e,i){return i.stopPropagation(),this.router.navigate(["/timeline"],{queryParams:{[t]:e}}).then(console.log),!1}getSearchCriteria(t,e){let i=new V;switch(t){case"category":i.category=e;break;case"city":i.city=e;break;case"country":i.country=e;break;case"year":i.year=e;break}return i}getPercentage(t,e){return Math.round(t/e*100)}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-statistics-panel"]],inputs:{data:[1,"data"],header:[1,"header"],type:[1,"type"]},standalone:!0,features:[_],decls:7,vars:3,consts:[[1,"mt-3","p-2","rounded-2","d-flex","flex-column"],[1,"gradient-bg","rounded-2","border","border-primary"],["data-bs-toggle","collapse","aria-expanded","true",1,"text-decoration-none","text-light","ps-2","w-100","fs-5","d-flex","toggle-link","d-inline-flex","align-items-center","justify-content-between",3,"href"],[1,"card-group","gap-2","show","ps-2",3,"id"],[1,"text-decoration-none","card","border","border-primary","border-1","rounded-2",3,"ngClass"],[1,"text-decoration-none","card","border","border-primary","border-1","rounded-2",3,"click","keyup.enter","ngClass"],[1,"card-statistics","p-4"],[1,"mb-4","d-inline-flex","justify-content-around","w-100"],[1,"card-title","gradient-text","mb-0"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"bi","bi-clock-history"],[1,"row","align-items-center","mb-2","d-flex"],[1,"col-8"],[1,"d-flex","align-items-center","mb-0","gradient-text"],[1,"col-4","text-right","gradient-text"],["mode","determinate",3,"value"]],template:function(e,i){e&1&&(o(0,"section",0)(1,"legend",1)(2,"a",2),m(3),s()(),o(4,"div",3),P(5,R,15,5,"button",4,U),s()()),e&2&&(n(2),a("href","#"+i.header(),w),n(),C(" ",i.header()," "),n(),a("id",i.header()),n(),k(i.data().sort(i.comparatorFn)))},dependencies:[z,E],styles:[".card[_ngcontent-%COMP%]{cursor:pointer;max-width:20rem!important;width:20rem!important;min-width:20rem!important}"],changeDetection:0})}}return r})();function Y(r,l){if(r&1&&d(0,"app-statistics-panel",1)(1,"app-statistics-panel",2)(2,"app-statistics-panel",3)(3,"app-statistics-panel",4),r&2){let t=p();a("data",t.statistics().years),n(),a("data",t.statistics().countries),n(),a("data",t.statistics().cities),n(),a("data",t.statistics().categories)}}var ft=(()=>{class r{constructor(){this.STATISTICS_PAGE_INFO=M,this.statisticsService=u(H),this.statistics=N(this.statisticsService.getStatistics())}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=g({type:r,selectors:[["app-statistics"]],standalone:!0,features:[_],decls:2,vars:2,consts:[[3,"pageInfo"],["type","year","header","Years",3,"data"],["type","country","header","Countries",3,"data"],["type","city","header","Cities",3,"data"],["type","category","header","Categories",3,"data"]],template:function(e,i){e&1&&(d(0,"app-page-header",0),T(1,Y,4,4)),e&2&&(a("pageInfo",i.STATISTICS_PAGE_INFO),n(),I(i.statistics()?1:-1))},dependencies:[O,L],changeDetection:0})}}return r})();export{ft as StatisticsComponent};
